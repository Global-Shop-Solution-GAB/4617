Program.Sub.ScreenSU.Start
Gui.frmResched..Create
Gui.frmResched..Size(15435,10800)
Gui.frmResched..MinX(0)
Gui.frmResched..MinY(0)
Gui.frmResched..Position(0,0)
Gui.frmResched..BackColor(-2147483633)
Gui.frmResched..MousePointer(0)
Gui.frmResched..Event(UnLoad,frmResched_UnLoad)
Gui.frmResched..Caption("Replace, Update, and Reschedule Utility")
Gui.frmResched.tabResched.Create(Tab)
Gui.frmResched.tabResched.Size(15060,8460)
Gui.frmResched.tabResched.Position(15,1020)
Gui.frmResched.tabResched.Event(Click,tabResched_Click)
Gui.frmResched.tabResched.Tabs(3)
Gui.frmResched.tabResched.SetTab(0)
Gui.frmResched.tabResched.Caption("By WC")
Gui.frmResched.tabResched.SetTab(1)
Gui.frmResched.tabResched.Caption("By Router")
Gui.frmResched.tabResched.SetTab(2)
Gui.frmResched.tabResched.Caption("By Part")
Gui.frmResched.GsGCWC.Create(GsGridControl)
Gui.frmResched.GsGCWC.Size(14895,7380)
Gui.frmResched.GsGCWC.Position(30,660)
Gui.frmResched.GsGCWC.Parent("tabResched",0)
Gui.frmResched.GsGCWC.Event(RowCellClick,GsGCWC_RowCellClick)
Gui.frmResched.GsGCWC.Event(CellValueChanged,GsGCWC_CellValueChanged)
Gui.frmResched.GsGCWC.Event(ColumnFilterChanged,GsGCWC_ColumnFilterChanged)
Gui.frmResched.GsGCRouter.Create(GsGridControl)
Gui.frmResched.GsGCRouter.Size(14895,7065)
Gui.frmResched.GsGCRouter.Position(30,975)
Gui.frmResched.GsGCRouter.Parent("tabResched",1)
Gui.frmResched.GsGCRouter.Event(RowCellClick,GsGCRouter_RowCellClick)
Gui.frmResched.GsGCPart.Create(GsGridControl)
Gui.frmResched.GsGCPart.Size(14895,7305)
Gui.frmResched.GsGCPart.Position(30,735)
Gui.frmResched.GsGCPart.Parent("tabResched",2)
Gui.frmResched.GsGCPart.Event(CellValueChanged,GsGCPart_CellValueChanged)
Gui.frmResched.ddlWC.Create(DropDownList)
Gui.frmResched.ddlWC.Size(1305,330)
Gui.frmResched.ddlWC.Position(690,105)
Gui.frmResched.ddlWC.Parent("tabResched",0)
Gui.frmResched.ddlWC.Event(Click,ddlWC_Click)
Gui.frmResched.cmdRouter.Create(Button)
Gui.frmResched.cmdRouter.Size(420,345)
Gui.frmResched.cmdRouter.Position(2070,570)
Gui.frmResched.cmdRouter.Parent("tabResched",1)
Gui.frmResched.cmdRouter.Caption("^")
Gui.frmResched.cmdRouter.Event(Click,cmdRouter_Click)
Gui.frmResched.cmdReplace.Create(Button)
Gui.frmResched.cmdReplace.Visible(False)
Gui.frmResched.cmdReplace.Size(420,345)
Gui.frmResched.cmdReplace.Position(4830,570)
Gui.frmResched.cmdReplace.Parent("tabResched",1)
Gui.frmResched.cmdReplace.Caption("^")
Gui.frmResched.cmdReplace.Event(Click,cmdReplace_Click)
Gui.frmResched.txtRouter.Create(TextBox,"",True,1965,300,0,75,585,True,0,"Arial",8,-2147483643,1)
Gui.frmResched.txtRouter.Parent("tabResched",1)
Gui.frmResched.txtRouter.Event(LostFocus,txtRouter_LostFocus)
Gui.frmResched.txtReplace.Create(TextBox,"",False,1965,300,0,2835,585,True,0,"Arial",8,-2147483643,1)
Gui.frmResched.txtReplace.Parent("tabResched",1)
Gui.frmResched.chkReplace.Create(CheckBox)
Gui.frmResched.chkReplace.Size(2670,285)
Gui.frmResched.chkReplace.Position(75,60)
Gui.frmResched.chkReplace.Parent("tabResched",1)
Gui.frmResched.chkReplace.Caption("Replace Current Router on WO")
Gui.frmResched.chkReplace.Event(Click,chkReplace_Click)
Gui.frmResched.lblReplace.Create(Label,"New Router:",False,1935,210,0,2865,405,True,0,"Arial",8,-986896,0)
Gui.frmResched.lblReplace.Parent("tabResched",1)
Gui.frmResched.lblRouter.Create(Label,"Router:",True,1935,210,0,75,405,True,0,"Arial",8,-986896,0)
Gui.frmResched.lblRouter.Parent("tabResched",1)
Gui.frmResched.lblRtrNote.Create(Label,"****Current Router will be replaced with the New Router for the selected jobs below****",False,6900,255,0,2835,105,True,0,"Arial",8,-986896,0)
Gui.frmResched.lblRtrNote.Parent("tabResched",1)
Gui.frmResched.lblRtrNote.FontStyle(True,False,False,False,False)
Gui.frmResched.lblRtrNote.ForeColor(255)
Gui.frmResched.optWG.Create(Option)
Gui.frmResched.optWG.Size(615,255)
Gui.frmResched.optWG.Position(45,300)
Gui.frmResched.optWG.Parent("tabResched",0)
Gui.frmResched.optWG.Caption("WG")
Gui.frmResched.optWG.Event(Click,optWG_Click)
Gui.frmResched.optWC.Create(Option)
Gui.frmResched.optWC.Size(600,255)
Gui.frmResched.optWC.Position(45,15)
Gui.frmResched.optWC.Parent("tabResched",0)
Gui.frmResched.optWC.Caption("WC")
Gui.frmResched.optWC.Event(Click,optWC_Click)
Gui.frmResched.ddlWG.Create(DropDownList)
Gui.frmResched.ddlWG.Visible(False)
Gui.frmResched.ddlWG.Size(1305,330)
Gui.frmResched.ddlWG.Position(690,105)
Gui.frmResched.ddlWG.Parent("tabResched",0)
Gui.frmResched.ddlWG.BackColor(16777215)
Gui.frmResched.ddlWG.ForeColor(0)
Gui.frmResched.ddlWG.Event(Click,ddlWC_Click)
Gui.frmResched.txtPart.Create(TextBox,"",True,1965,300,0,75,315,True,0,"Arial",8,-2147483643,1)
Gui.frmResched.txtPart.Parent("tabResched",2)
Gui.frmResched.txtNewPart.Create(TextBox,"",True,1965,300,0,3480,315,True,0,"Arial",8,-2147483643,1)
Gui.frmResched.txtNewPart.Parent("tabResched",2)
Gui.frmResched.txtNewPart.ForeColor(0)
Gui.frmResched.cmdPart.Create(Button)
Gui.frmResched.cmdPart.Size(420,345)
Gui.frmResched.cmdPart.Position(2670,300)
Gui.frmResched.cmdPart.Parent("tabResched",2)
Gui.frmResched.cmdPart.Caption("^")
Gui.frmResched.cmdPart.Event(Click,cmdPart_Click)
Gui.frmResched.cmdNewPart.Create(Button)
Gui.frmResched.cmdNewPart.Size(420,345)
Gui.frmResched.cmdNewPart.Position(6075,300)
Gui.frmResched.cmdNewPart.Parent("tabResched",2)
Gui.frmResched.cmdNewPart.Caption("^")
Gui.frmResched.cmdNewPart.Event(Click,cmdNewPart_Click)
Gui.frmResched.lblPart.Create(Label,"Current Part:",True,1380,210,0,75,120,True,0,"Arial",8,-986896,0)
Gui.frmResched.lblPart.Parent("tabResched",2)
Gui.frmResched.lblNewPart.Create(Label,"New Part:",True,1380,210,0,3480,120,True,0,"Arial",8,-986896,0)
Gui.frmResched.lblNewPart.Parent("tabResched",2)
Gui.frmResched.lblLoc.Create(Label,"Loc:",True,750,210,0,2115,120,True,0,"Arial",8,15790320,0)
Gui.frmResched.lblLoc.Parent("tabResched",2)
Gui.frmResched.lblLoc.ForeColor(0)
Gui.frmResched.txtLoc.Create(TextBox,"",True,495,300,0,2115,315,True,0,"Arial",8,-2147483643,1)
Gui.frmResched.txtLoc.Parent("tabResched",2)
Gui.frmResched.txtLoc.ForeColor(0)
Gui.frmResched.txtLoc.Event(LostFocus,txtLoc_LostFocus)
Gui.frmResched.txtNewLoc.Create(TextBox,"",True,495,300,0,5520,315,True,0,"Arial",8,-2147483643,1)
Gui.frmResched.txtNewLoc.Parent("tabResched",2)
Gui.frmResched.txtNewLoc.ForeColor(0)
Gui.frmResched.txtNewLoc.Event(LostFocus,txtNewLoc_LostFocus)
Gui.frmResched.lblNewLoc.Create(Label,"Loc:",True,750,210,0,5520,120,True,0,"Arial",8,15790320,0)
Gui.frmResched.lblNewLoc.Parent("tabResched",2)
Gui.frmResched.lblNewLoc.ForeColor(0)
Gui.frmResched.picLegend.Create(PictureBox)
Gui.frmResched.picLegend.Size(255,255)
Gui.frmResched.picLegend.Position(14625,30)
Gui.frmResched.picLegend.Parent("tabResched",0)
Gui.frmResched.picLegend.BackColor(13353215)
Gui.frmResched.lblLegend.Create(Label,"Late - ",True,510,195,0,14040,45,True,0,"Arial",8,-986896,0)
Gui.frmResched.lblLegend.Parent("tabResched",0)
Gui.frmResched.lblLegend2.Create(Label,"Ready - ",True,720,195,0,13860,345,True,0,"Arial",8,15790320,0)
Gui.frmResched.lblLegend2.Parent("tabResched",0)
Gui.frmResched.picLegend2.Create(PictureBox)
Gui.frmResched.picLegend2.Size(255,255)
Gui.frmResched.picLegend2.Position(14625,345)
Gui.frmResched.picLegend2.Parent("tabResched",0)
Gui.frmResched.picLegend2.BackColor(9498256)
Gui.frmResched.lblLegend3.Create(Label,"Prev. Seq. Closed and Prev. Compl. Qty is not equal to Est. Qty. - ",True,4965,195,0,8280,30,True,0,"Arial",8,15790320,0)
Gui.frmResched.lblLegend3.Parent("tabResched",0)
Gui.frmResched.picLegend3.Create(PictureBox)
Gui.frmResched.picLegend3.Size(255,255)
Gui.frmResched.picLegend3.Position(13260,30)
Gui.frmResched.picLegend3.Parent("tabResched",0)
Gui.frmResched.picLegend3.BackColor(8036607)
Gui.frmResched.cmdDisplay.Create(Button)
Gui.frmResched.cmdDisplay.Size(855,375)
Gui.frmResched.cmdDisplay.Position(4215,75)
Gui.frmResched.cmdDisplay.Parent("tabResched",0)
Gui.frmResched.cmdDisplay.Caption("Display")
Gui.frmResched.cmdDisplay.Event(Click,cmdDisplay_Click)
Gui.frmResched.ddlList.Create(DropDownList)
Gui.frmResched.ddlList.Size(1335,330)
Gui.frmResched.ddlList.Position(2670,105)
Gui.frmResched.ddlList.Parent("tabResched",0)
Gui.frmResched.picGSSLogo.Create(PictureBox)
Gui.frmResched.picGSSLogo.Size(4125,960)
Gui.frmResched.picGSSLogo.Position(5085,105)
Gui.frmResched.picGSSLogo.Event(DblClick,picGSSLogo_DblClick)
Gui.frmResched.frameTotals.Create(Frame)
Gui.frmResched.frameTotals.Size(3645,855)
Gui.frmResched.frameTotals.Position(11430,9480)
Gui.frmResched.txtAct.Create(TextBox,"",True,1050,300,0,1275,405,True,1,"Arial",8,-2147483643,1)
Gui.frmResched.txtAct.Parent("frameTotals")
Gui.frmResched.txtAct.Mask(0)
Gui.frmResched.txtAct.Locked(True)
Gui.frmResched.txtEst.Create(TextBox,"",True,1050,300,0,105,405,True,1,"Arial",8,-2147483643,1)
Gui.frmResched.txtEst.Parent("frameTotals")
Gui.frmResched.txtEst.Mask(0)
Gui.frmResched.txtEst.Locked(True)
Gui.frmResched.txtRem.Create(TextBox,"",True,1050,300,0,2475,405,True,1,"Arial",8,-2147483643,1)
Gui.frmResched.txtRem.Parent("frameTotals")
Gui.frmResched.txtRem.Mask(0)
Gui.frmResched.txtRem.Locked(True)
Gui.frmResched.lblEst.Create(Label,"Tot Est Hrs",True,1035,255,0,120,195,True,0,"Arial",8,-2147483633,0)
Gui.frmResched.lblEst.Parent("frameTotals")
Gui.frmResched.lblRem.Create(Label,"Tot Rem Hrs",True,1095,255,0,2460,195,True,0,"Arial",8,-2147483633,0)
Gui.frmResched.lblRem.Parent("frameTotals")
Gui.frmResched.lblRem.DefaultValue("")
Gui.frmResched.lblAct.Create(Label,"Tot Act Hrs",True,915,255,0,1350,195,True,0,"Arial",8,-2147483633,0)
Gui.frmResched.lblAct.Parent("frameTotals")
Gui.frmResched.pbStatus.Create(ProgressBar)
Gui.frmResched.pbStatus.Visible(False)
Gui.frmResched.pbStatus.Size(3735,255)
Gui.frmResched.pbStatus.Position(75,375)
Gui.frmResched.lblStatus.Create(Label,"****Change****",False,3765,255,0,75,135,True,0,"Arial",8,-986896,0)
Gui.frmResched.frameSched.Create(Frame)
Gui.frmResched.frameSched.Size(2760,450)
Gui.frmResched.frameSched.Position(12285,540)
Gui.frmResched.optFwd.Create(Option)
Gui.frmResched.optFwd.Size(645,195)
Gui.frmResched.optFwd.Position(855,150)
Gui.frmResched.optFwd.Caption("Fwd")
Gui.frmResched.optFwd.Parent("frameSched")
Gui.frmResched.optBwd.Create(Option)
Gui.frmResched.optBwd.Size(690,195)
Gui.frmResched.optBwd.Position(120,150)
Gui.frmResched.optBwd.Caption("Bwd")
Gui.frmResched.optBwd.Parent("frameSched")
Gui.frmResched.optHere.Create(Option)
Gui.frmResched.optHere.Size(1125,195)
Gui.frmResched.optHere.Position(1545,150)
Gui.frmResched.optHere.Parent("frameSched")
Gui.frmResched.optHere.Caption("From Here")
Gui.frmResched.optHere.BackColor(15790320)
Gui.frmResched.optHere.ForeColor(0)
Gui.frmResched.frameButtons.Create(Frame)
Gui.frmResched.frameButtons.Size(4950,600)
Gui.frmResched.frameButtons.Position(10080,-15)
Gui.frmResched.cmdNew.Create(Button)
Gui.frmResched.cmdNew.Size(840,375)
Gui.frmResched.cmdNew.Position(1860,165)
Gui.frmResched.cmdNew.Caption("New WO")
Gui.frmResched.cmdNew.Enabled(False)
Gui.frmResched.cmdNew.Parent("frameButtons")
Gui.frmResched.cmdNew.Event(Click,cmdNew_Click)
Gui.frmResched.cmdRefresh.Create(Button)
Gui.frmResched.cmdRefresh.Size(840,375)
Gui.frmResched.cmdRefresh.Position(60,165)
Gui.frmResched.cmdRefresh.Caption("REFRESH")
Gui.frmResched.cmdRefresh.Parent("frameButtons")
Gui.frmResched.cmdRefresh.Event(Click,cmdRefresh_Click)
Gui.frmResched.cmdExport.Create(Button)
Gui.frmResched.cmdExport.Size(840,375)
Gui.frmResched.cmdExport.Position(960,165)
Gui.frmResched.cmdExport.Caption("Export")
Gui.frmResched.cmdExport.Parent("frameButtons")
Gui.frmResched.cmdExport.Event(Click,cmdExport_Click)
Gui.frmResched.txtDept.Create(TextBox,"",True,705,300,0,3390,225,True,0,"Arial",8,-2147483643,1)
Gui.frmResched.txtDept.Parent("frameButtons")
Gui.frmResched.lblDept.Create(Label,"Dept.",True,450,255,0,2850,285,True,0,"Arial",8,-2147483633,0)
Gui.frmResched.lblDept.Parent("frameButtons")
Gui.frmResched.cmdDeptBrowse.Create(Button)
Gui.frmResched.cmdDeptBrowse.Size(510,330)
Gui.frmResched.cmdDeptBrowse.Position(4185,225)
Gui.frmResched.cmdDeptBrowse.Caption("^")
Gui.frmResched.cmdDeptBrowse.Event(Click,cmdDeptBrowse_Click)
Gui.frmResched.cmdDeptBrowse.Parent("frameButtons")
Gui.frmResched.cmdSched.Create(Button)
Gui.frmResched.cmdSched.Size(900,450)
Gui.frmResched.cmdSched.Position(75,9600)
Gui.frmResched.cmdSched.Caption("Schedule")
Gui.frmResched.cmdSched.Event(Click,cmdSched_Click)
Gui.frmResched.cmdClearSel.Create(Button)
Gui.frmResched.cmdClearSel.Size(900,450)
Gui.frmResched.cmdClearSel.Position(1065,9600)
Gui.frmResched.cmdClearSel.Caption("Clear Selected")
Gui.frmResched.cmdClearSel.Event(Click,cmdClearSel_Click)
Gui.frmResched.cmdClearScr.Create(Button)
Gui.frmResched.cmdClearScr.Size(900,450)
Gui.frmResched.cmdClearScr.Position(2055,9600)
Gui.frmResched.cmdClearScr.Caption("Clear Screen")
Gui.frmResched.cmdClearScr.Event(Click,cmdClearScr_Click)
Gui.frmResched.framePermissions.Create(Frame)
Gui.frmResched.framePermissions.Size(1965,390)
Gui.frmResched.framePermissions.Position(13080,930)
Gui.frmResched.framePermissions.Visible(False)
Gui.frmResched.optView.Create(Option)
Gui.frmResched.optView.Size(690,195)
Gui.frmResched.optView.Position(225,150)
Gui.frmResched.optView.Caption("View")
Gui.frmResched.optView.BackColor(15790320)
Gui.frmResched.optView.ForeColor(0)
Gui.frmResched.optView.Parent("framePermissions")
Gui.frmResched.optEdit.Create(Option)
Gui.frmResched.optEdit.Enabled(False)
Gui.frmResched.optEdit.Size(690,195)
Gui.frmResched.optEdit.Position(1050,150)
Gui.frmResched.optEdit.Caption("Edit")
Gui.frmResched.optEdit.Parent("framePermissions")
Gui.frmWeb..Create
Gui.frmWeb..Caption("Global Shop Solutions - Web Sites")
Gui.frmWeb..Size(4035,1695)
Gui.frmWeb..MinX(0)
Gui.frmWeb..MinY(0)
Gui.frmWeb..Position(0,0)
Gui.frmWeb..BackColor(-2147483633)
Gui.frmWeb..MousePointer(0)
Gui.frmWeb..MaxButton(False)
Gui.frmWeb..Sizeable(False)
Gui.frmWeb..Event(UnLoad,frmWeb_UnLoad)
Gui.frmWeb..MinButton(False)
Gui.frmWeb.cmdGSS.Create(Button)
Gui.frmWeb.cmdGSS.Size(3615,375)
Gui.frmWeb.cmdGSS.Position(120,45)
Gui.frmWeb.cmdGSS.Caption("Global Shop Solutions")
Gui.frmWeb.cmdGSS.Event(Click,cmdGSS_Click)
Gui.frmWeb.cmdServ.Create(Button)
Gui.frmWeb.cmdServ.Size(3615,375)
Gui.frmWeb.cmdServ.Position(120,450)
Gui.frmWeb.cmdServ.Caption("ServiceWeb")
Gui.frmWeb.cmdServ.Event(Click,cmdServ_Click)
Gui.frmWeb.cmdUpd.Create(Button)
Gui.frmWeb.cmdUpd.Size(3615,375)
Gui.frmWeb.cmdUpd.Position(120,855)
Gui.frmWeb.cmdUpd.Caption("GSS Updates")
Gui.frmWeb.cmdUpd.Event(Click,cmdUpd_Click)
Program.Sub.ScreenSU.End

Program.Sub.Preflight.Start
	V.Global.sWC.Declare
	V.Global.sWCList.Declare
	V.Global.sRouter.Declare
	V.Global.sNewRouter.Declare
	V.Global.sNewRouterDesc.Declare
	V.Global.sPart.Declare
	V.Global.sLoc.Declare
	V.Global.sNewPart.Declare
	V.Global.sNewPartDesc.Declare
	V.Global.sNewLoc.Declare
	V.Global.bEdit.Declare(Boolean,False)
V.Global.sWCdisplay.Declare(String)
V.Global.sWGdisplay.Declare(String)
Program.Sub.Preflight.End

Program.Sub.Main.Start
F.Intrinsic.Control.SetErrorHandler("Main_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)



	'Hooks: 11010 and 11120

	V.Local.sIcon.Declare(String)
	V.Local.sGssLogo.Declare(String)
	V.Local.bEdit.Declare(Boolean)
	V.Local.bPassed.Declare(Boolean)
	
	F.Intrinsic.Control.If(V.Caller.Hook,=,11010)
		V.Passed.000201.Set("Resched Rtr")
		F.Intrinsic.Control.End

	F.Intrinsic.Control.EndIf

	F.Intrinsic.String.Build("{0}\GAB\GAS\gss2.ico",V.Caller.PluginsDir,v.Local.sIcon)
	F.Intrinsic.String.Build("{0}\GAB\GAS\GAB_GSS_Logo_Green_Dash.png",V.Caller.PluginsDir,V.Local.sGssLogo)
'	Gui.frmWeb..Icon(V.Local.sIcon)
	'Gui.frmResched..Icon(V.Local.sIcon)
	'Gui.frmResched.picGSSLogo.Picture(V.Local.sGssLogo)

	F.Global.Security.IsInGroup(V.Caller.User,"EditWO",V.Caller.CompanyCode,V.Local.bEdit)
	F.Intrinsic.Control.If(V.Local.bEdit)
		Gui.frmResched.cmdNew.Enabled(True)
		V.Global.bEdit.Set(True)
	F.Intrinsic.Control.Else
		V.Global.bEdit.Set(False)
		Gui.frmResched.tabResched.TabVisible(1,False)
		Gui.frmResched.tabResched.TabVisible(2,False)
	F.Intrinsic.Control.EndIf

	Gui.frmResched.optBwd.Value(True)
	Gui.frmResched.optWC.Value(True)

	F.ODBC.Connection!con.OpenConnection(V.Ambient.PDSN,V.Ambient.PUser,V.Ambient.PPass,600)
	F.Intrinsic.Control.CallSub(setanchors)
	F.Intrinsic.Control.CallSub(loadddlists)
	F.Intrinsic.Control.CallSub(loadtextboxes)

	'Check if being called from 4200-Master Schedule
	F.Intrinsic.Variable.PassedExists("WC",V.Local.bPassed)
	F.Intrinsic.Control.If(V.Local.bPassed)
		Gui.frmResched.optWC.Value(True)
		Gui.frmResched.ddlWC.Text(V.Passed.WC)
	F.Intrinsic.Control.Else
		F.Intrinsic.Variable.PassedExists("WG",V.Local.bPassed)
		F.Intrinsic.Control.If(V.Local.bPassed)
			Gui.frmResched.optWG.Value(True)
			F.Intrinsic.Control.CallSub(optwg_click)
			Gui.frmResched.ddlWG.Text(V.Passed.WG)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.If(V.Caller.Hook,=,11120)
		F.Intrinsic.Control.If(V.Passed.000014,=,"")
			F.Intrinsic.UI.Msgbox("Please select a Router first.","Router Validation")
			F.Intrinsic.Control.End

		F.Intrinsic.Control.Else
			Gui.frmResched.tabResched.SetTab(1)
			F.Intrinsic.String.GSSPartString(V.Passed.000014.Trim,V.Passed.000015.Trim,V.Global.sRouter)
			Gui.frmResched.txtRouter.Text(V.Global.sRouter)
			V.Global.sNewRouter.Set("")
			Gui.frmResched.GsGCRouter.Visible(False)
			F.Intrinsic.Control.CallSub(LoadDTRouter)
			Gui.frmResched.GsGCRouter.Visible(True)
			Gui.frmResched.frameTotals.Visible(False)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.ElseIf(V.Local.bPassed)
		Gui.frmResched.tabResched.SetTab(0)
		F.Intrinsic.Control.CallSub(ddlwc_click)
	F.Intrinsic.Control.Else
		Gui.frmResched.tabResched.SetTab(0)
	F.Intrinsic.Control.EndIf

	Gui.frmResched..Show



F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Main_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf


Program.Sub.Main.End

Program.Sub.SetAnchors.Start
F.Intrinsic.Control.SetErrorHandler("SetAnchors_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)


	'0 - None
	'1 - Top
	'2 - Bottom
	'4 - Left
	'8 - Right

	Gui.frmResched.picGSSLogo.Anchor(1)
	Gui.frmResched.lblStatus.Anchor(5)
	Gui.frmResched.pbStatus.Anchor(5)
	Gui.frmResched.frameButtons.Anchor(9)
	Gui.frmResched.frameSched.Anchor(9)
	Gui.frmResched.frameTotals.Anchor(10)
	Gui.frmResched.tabResched.Anchor(15)
	Gui.frmResched.GsGCWC.Anchor(15)
	Gui.frmResched.GsGCRouter.Anchor(15)
	Gui.frmResched.GsGCPart.Anchor(15)
	Gui.frmResched.cmdSched.Anchor(6)
	Gui.frmResched.cmdClearSel.Anchor(6)
	Gui.frmResched.cmdClearScr.Anchor(6)
	Gui.frmResched.lblLegend.Anchor(9)
	Gui.frmResched.picLegend.Anchor(9)
	Gui.frmResched.lblLegend2.Anchor(9)
	Gui.frmResched.picLegend2.Anchor(9)
	Gui.frmResched.lblLegend3.Anchor(9)
	Gui.frmResched.picLegend3.Anchor(9)

	'Set TabStops
	Gui.frmResched.cmdRefresh.TabStop(True)
	Gui.frmResched.cmdRefresh.TabIndex(1)
	Gui.frmResched.cmdExport.TabStop(True)
	Gui.frmResched.cmdExport.TabIndex(2)
	Gui.frmResched.cmdNew.TabStop(True)
	Gui.frmResched.cmdNew.TabIndex(3)
	Gui.frmResched.optBwd.TabStop(True)
	Gui.frmResched.optBwd.TabIndex(4)
	Gui.frmResched.optFwd.TabStop(True)
	Gui.frmResched.optFwd.TabIndex(5)
	Gui.frmResched.optHere.TabStop(True)
	Gui.frmResched.optHere.TabIndex(6)
	Gui.frmResched.optWC.TabStop(True)
	Gui.frmResched.optWC.TabIndex(7)
	Gui.frmResched.optWG.TabStop(True)
	Gui.frmResched.optWG.TabIndex(8)
	Gui.frmResched.ddlWC.TabStop(True)
	Gui.frmResched.ddlWC.TabIndex(9)
	Gui.frmResched.chkReplace.TabStop(True)
	Gui.frmResched.chkReplace.TabIndex(10)
	Gui.frmResched.txtRouter.TabStop(True)
	Gui.frmResched.txtRouter.TabIndex(11)
	Gui.frmResched.cmdRouter.TabStop(True)
	Gui.frmResched.cmdRouter.TabIndex(12)
	Gui.frmResched.txtReplace.TabStop(True)
	Gui.frmResched.txtReplace.TabIndex(13)
	Gui.frmResched.cmdReplace.TabStop(True)
	Gui.frmResched.cmdReplace.TabIndex(14)
	Gui.frmResched.txtPart.TabStop(True)
	Gui.frmResched.txtPart.TabIndex(15)
	Gui.frmResched.txtLoc.TabStop(True)
	Gui.frmResched.txtLoc.TabIndex(16)
	Gui.frmResched.cmdPart.TabStop(True)
	Gui.frmResched.cmdPart.TabIndex(17)
	Gui.frmResched.txtNewPart.TabStop(True)
	Gui.frmResched.txtNewPart.TabIndex(18)
	Gui.frmResched.txtNewLoc.TabStop(True)
	Gui.frmResched.txtNewLoc.TabIndex(19)
	Gui.frmResched.cmdNewPart.TabStop(True)
	Gui.frmResched.cmdNewPart.TabIndex(20)
	Gui.frmResched.cmdSched.TabStop(True)
	Gui.frmResched.cmdSched.TabIndex(21)
	Gui.frmResched.cmdClearSel.TabStop(True)
	Gui.frmResched.cmdClearSel.TabIndex(22)
	Gui.frmResched.cmdClearScr.TabStop(True)
	Gui.frmResched.cmdClearScr.TabIndex(23)



F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("SetAnchors_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf


Program.Sub.SetAnchors.End

Program.Sub.frmResched_UnLoad.Start
F.Intrinsic.Control.SetErrorHandler("frmResched_UnLoad_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)


	F.ODBC.Connection!con.Close
	F.Intrinsic.Control.End

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("frmResched_UnLoad_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf


Program.Sub.frmResched_UnLoad.End

Program.Sub.picGSSLogo_DblClick.Start
F.Intrinsic.Control.SetErrorHandler("picGSSLogo_DblClick_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)


	Gui.frmWeb..Show
	


F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("picGSSLogo_DblClick_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf


Program.Sub.picGSSLogo_DblClick.End

Program.Sub.frmWeb_UnLoad.Start
F.Intrinsic.Control.SetErrorHandler("frmWeb_UnLoad_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)


	Gui.frmWeb..Visible(False)
	


F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("frmWeb_UnLoad_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf


Program.Sub.frmWeb_UnLoad.End

Program.Sub.cmdGSS_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdGSS_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)


	F.Intrinsic.Task.ShellExec(0,"Open","http://www.globalshopsolutions.com/","","",0)
	


F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdGSS_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf


Program.Sub.cmdGSS_Click.End

Program.Sub.cmdServ_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdServ_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)


	F.Intrinsic.Task.ShellExec(0,"Open","http://gss-service.com/","","",0)
	


F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdServ_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf


Program.Sub.cmdServ_Click.End

Program.Sub.cmdUpd_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdUpd_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)


	F.Intrinsic.Task.ShellExec(0,"Open","http://gss-updates.com/","","",0)
	


F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdUpd_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf


Program.Sub.cmdUpd_Click.End

Program.Sub.cmdSched_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdSched_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)


	V.Local.sSched.Declare(String)
	V.Local.iRet.Declare(Long)
	V.Local.sRet.Declare(String)
	V.Local.bSel.Declare(Boolean)
	V.Local.bSched.Declare(Boolean)
	V.Local.sJob.Declare(String)
	V.Local.sSuffix.Declare(String)
	V.Local.sSeq.Declare(String)
	V.Local.sPriority.Declare(String)
	V.Local.sWC.Declare(String)
	V.Local.sWCDesc.Declare(String)
	V.Local.fWCRate.Declare(Float)
	V.Local.fWCCrewSize.Declare(Float)
	V.Local.fWCFloat.Declare(Float)
	V.Local.fWCPerMod.Declare(Float)
	V.Local.sStartDate.Declare(String)
	V.Local.sDueDate.Declare(String)
	V.Local.sParams500030.Declare(String)
	V.Local.sParams5101.Declare(String)
	V.Local.sParams5100.Declare(String)
	V.Local.sSQL.Declare(String)
	V.Local.iCnt.Declare(Long)
	V.Local.fSetup.Declare(Float)
	V.Local.fRuntime.Declare(Float)

	F.Intrinsic.Control.If(V.Screen.frmResched!optBwd.Value)
		V.Local.sSched.Set("B")
	F.Intrinsic.Control.ElseIf(V.Screen.frmResched!optFwd.Value)
		V.Local.sSched.Set("F")
	F.Intrinsic.Control.ElseIf(V.Screen.frmResched!optHere.Value)
		V.Local.sSched.Set("H")
	F.Intrinsic.Control.EndIf

	Gui.frmResched.lblStatus.Caption("Scheduling Work Orders....")
	Gui.frmResched.lblStatus.Visible(True)
	Gui.frmResched.pbStatus.Visible(True)
	Gui.frmResched.pbStatus.Min(0)

	F.Intrinsic.UI.Msgbox("Are you sure you want to continue?","Schedule Selected?",4,V.Local.iRet)
	F.Intrinsic.Control.If(V.Local.iRet,=,6)
		F.Intrinsic.Control.SelectCase(V.Screen.frmResched!tabResched.Tab)
			F.Intrinsic.Control.Case(0)
				F.Intrinsic.Control.CallSub(disablecontrols)
				F.Intrinsic.Control.If(V.DataTable.dtWC.Exists)
					Gui.frmResched.pbStatus.Max(V.DataTable.dtWC.RowCount)
					F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtWC.RowCount--,1)
						Gui.frmResched.pbStatus.Value(V.Local.iCnt)
						Gui.frmResched.GsGCWC.GetCellValue("gvWC",21,V.Local.iCnt,V.Local.bSel)
							F.Intrinsic.Control.If(V.Local.bSel,=,True)
								Gui.frmResched.GsGCWC.GetCellValue("gvWC",1,V.Local.iCnt,V.Local.sJob)
								Gui.frmResched.GsGCWC.GetCellValue("gvWC",2,V.Local.iCnt,V.Local.sSuffix)
								Gui.frmResched.GsGCWC.GetCellValue("gvWC",5,V.Local.iCnt,V.Local.sSeq)
								F.Intrinsic.String.LPad(V.Local.sSeq,"0",6,V.Local.sSeq)
								Gui.frmResched.GsGCWC.GetCellValue("gvWC",4,V.Local.iCnt,V.Local.sPriority)
								Gui.frmResched.GsGCWC.GetCellValue("gvWC",25,V.Local.iCnt,V.Local.sWC)
								F.Intrinsic.Control.If(V.Local.sWC,=,"")
									Gui.frmResched.GsGCWC.GetCellValue("gvWC",6,V.Local.iCnt,V.Local.sWC)
								F.Intrinsic.Control.EndIf
								Gui.frmResched.GsGCWC.GetCellValue("gvWC",13,V.Local.iCnt,V.Local.sDueDate)
								F.Intrinsic.String.Format(V.Local.sDueDate,"MMDDYY",V.Local.sDueDate)
								Gui.frmResched.GsGCWC.GetCellValue("gvWC",20,V.Local.iCnt,V.Local.sStartDate)
								F.Intrinsic.String.Format(V.Local.sStartDate,"MMDDYY",V.Local.sStartDate)

								F.Intrinsic.String.Build("UPDATE JOB_HEADER SET PRIORITY = '{0}',DATE_DUE = '{1}' WHERE JOB = '{2}' AND SUFFIX = '{3}';",V.Local.sPriority,V.Local.sDueDate,V.Local.sJob,V.Local.sSuffix,V.Local.sSQL)
								F.ODBC.Connection!con.Execute(V.Local.sSQL)

								F.Intrinsic.String.Build("SELECT WC_NAME,STANDARD_COST,FLOAT,SCHED_PCT_MOD,CREWSIZE,NO_MACHINES,PROJ_GROUP FROM WORKCENTERS WHERE MACHINE = '{0}';",V.Local.sWC.Trim,V.Local.sSQL)
								F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSQL,V.Local.sRet)
								F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
								V.Local.sWCDesc.Set(V.Local.sRet(0))
								F.Intrinsic.String.Replace(V.Local.sWCDesc,"'","''",V.Local.sWCDesc)
								V.Local.fWCRate.Set(V.Local.sRet(1))
								V.Local.fWCFloat.Set(V.Local.sRet(2))
								V.Local.fWCPerMod.Set(V.Local.sRet(3))
								V.Local.fWCCrewSize.Set(V.Local.sRet(4))
								F.Intrinsic.String.Build("UPDATE JOB_OPERATIONS SET PART = '{0}',DESCRIPTION = '{1}',BURDEN = '{2}',CREW_SIZE = '{3}' WHERE JOB = '{4}' AND SUFFIX = '{5}' AND SEQ = '{6}';",V.Local.sWC.Trim,V.Local.sWCDesc,V.Local.fWCRate,V.Local.fWCCrewSize,V.Local.sJob,V.Local.sSuffix,V.Local.sSeq,V.Local.sSQL)
								F.ODBC.Connection!con.Execute(V.Local.sSQL)
								F.Intrinsic.String.Build("UPDATE SCHED_WO_SUPP SET POST_FLOAT = '{0}',PERC_MODIFIER = '{1}' WHERE WO = '{2}' AND WO_SUFFIX = '{3}' AND WO_SEQ = '{4}';",V.Local.fWCFloat,V.Local.fWCPerMod,V.Local.sJob,V.Local.sSuffix,V.Local.sSeq,V.Local.sSQL)
								F.ODBC.Connection!con.Execute(V.Local.sSQL)

								F.Intrinsic.String.Build("{0}!*!{1}!*!{2}!*!{3}!*!!*!{4}",V.Local.sStartDate,V.Local.sDueDate,V.Local.sJob,V.Local.sSuffix,V.Local.sSched,V.Local.sParams500030)
								F.Global.General.CallWrapperSync(500030,V.Local.sParams500030)
							F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.Next(V.Local.iCnt)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.CallSub(enablecontrols)
				F.Intrinsic.Control.CallSub(cmdrefresh_click)

			F.Intrinsic.Control.Case(1)
				F.Intrinsic.Control.CallSub(disablecontrols)
				F.Intrinsic.Control.If(V.DataTable.dtRouter.Exists)
					F.Intrinsic.Control.If(V.Screen.frmResched!chkReplace.Value,=,1)
						V.Global.sRouter.Set(V.Global.sNewRouter)
					F.Intrinsic.Control.EndIf
					Gui.frmResched.pbStatus.Max(V.DataTable.dtRouter.RowCount)
					F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtRouter.RowCount--,1)
						Gui.frmResched.pbStatus.Value(V.Local.iCnt)
						Gui.frmResched.GsGCRouter.GetCellValue("gvRouter",6,V.Local.iCnt,V.Local.bSel)
						Gui.frmResched.GsGCRouter.GetCellValue("gvRouter",9,V.Local.iCnt,V.Local.bSched)
							F.Intrinsic.Control.If(V.Local.bSel,=,True)
							F.Intrinsic.Control.AndIf(V.Local.bSched,=,"0")
								Gui.frmResched.GsGCRouter.GetCellValue("gvRouter",0,V.Local.iCnt,V.Local.sJob)
								Gui.frmResched.GsGCRouter.GetCellValue("gvRouter",1,V.Local.iCnt,V.Local.sSuffix)
								F.Intrinsic.String.Build("{0}!*!{1}",V.Local.sJob,V.Local.sSuffix,V.Local.sParams5101)
								F.Global.General.CallWrapperSync(5101,V.Local.sParams5101)
								F.Intrinsic.String.Build("{0}!*!{1}!*!{2}!*!{3}",V.Local.sJob,V.Local.sSuffix,V.Global.sRouter,V.Local.sSched,V.Local.sParams5100)
								F.Intrinsic.UI.Sleep(1)
								F.Global.General.CallWrapperSync(5100,V.Local.sParams5100)
								F.Data.DataTable.SetValue("dtRouter",V.Local.iCnt,"Scheduled",True)
								Gui.frmResched.GsGCRouter.SetCellAppearance("gvRouter",6,V.Local.iCnt,"BackColor","WhiteSmoke")
								F.Intrinsic.Control.If(V.Screen.frmResched!chkReplace.Value,=,1)
									F.Intrinsic.String.Build("UPDATE JOB_HEADER SET PART = '{0}', ROUTER = '{0}', DESCRIPTION = '{1}' WHERE JOB = '{2}' AND SUFFIX = '{3}';",V.Global.sRouter,V.Global.sNewRouterDesc,V.Local.sJob,V.Local.sSuffix,V.Local.sSQL)
									F.ODBC.Connection!con.Execute(V.Local.sSQL)
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.Next(V.Local.iCnt)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.CallSub(enablecontrols)

			F.Intrinsic.Control.Case(2)
				F.Intrinsic.Control.If(V.Screen.frmResched!txtNewPart.Text,=,"")
					F.Intrinsic.UI.Msgbox("No New Part Selected","Part Validation")
					F.Intrinsic.Control.ExitSub
				F.Intrinsic.Control.Else
					F.Intrinsic.Control.CallSub(disablecontrols)
					F.Intrinsic.Control.If(V.DataTable.dtPart.Exists)
						Gui.frmResched.pbStatus.Max(V.DataTable.dtPart.RowCount)
						F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtPart.RowCount--,1)
							Gui.frmResched.pbStatus.Value(V.Local.iCnt)
							Gui.frmResched.GsGCPart.GetCellValue("gvPart",14,V.Local.iCnt,V.Local.bSel)
								F.Intrinsic.Control.If(V.Local.bSel,=,True)
									Gui.frmResched.GsGCPart.GetCellValue("gvPart",0,V.Local.iCnt,V.Local.sJob)
									Gui.frmResched.GsGCPart.GetCellValue("gvPart",1,V.Local.iCnt,V.Local.sSuffix)
									Gui.frmResched.GsGCPart.GetCellValue("gvPart",2,V.Local.iCnt,V.Local.sSeq)
									Gui.frmResched.GsGCPart.GetCellValue("gvPart",7,V.Local.iCnt,V.Local.fSetup)
									Gui.frmResched.GsGCPart.GetCellValue("gvPart",9,V.Local.iCnt,V.Local.fRuntime)
									Gui.frmResched.GsGCPart.GetCellValue("gvPart",10,V.Local.iCnt,V.Local.sStartDate)
									F.Intrinsic.String.Format(V.Local.sStartDate,"MMDDYY",V.Local.sStartDate)
									Gui.frmResched.GsGCPart.GetCellValue("gvPart",11,V.Local.iCnt,V.Local.sDueDate)
									F.Intrinsic.String.Format(V.Local.sDueDate,"MMDDYY",V.Local.sDueDate)

									F.Intrinsic.String.Build("UPDATE JOB_OPERATIONS SET PART = '{0}',DESCRIPTION = '{1}',SETUP = '{2}',UNITS = '{3}',UNIT_D6 = '{3}' WHERE JOB = '{4}' AND SUFFIX = '{5}' AND SEQ = '{6}';",V.Global.sNewPart.Trim,V.Global.sNewPartDesc,V.Local.fSetup,V.Local.fRuntime,V.Local.sJob,V.Local.sSuffix,V.Local.sSeq,V.Local.sSQL)
									F.ODBC.Connection!con.Execute(V.Local.sSQL)

									F.Intrinsic.String.Build("{0}!*!{1}!*!{2}!*!{3}!*!!*!{4}",V.Local.sStartDate,V.Local.sDueDate,V.Local.sJob,V.Local.sSuffix,V.Local.sSched,V.Local.sParams500030)
									F.Global.General.CallWrapperSync(500030,V.Local.sParams500030)
								F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.Next(V.Local.iCnt)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.CallSub(enablecontrols)
				F.Intrinsic.Control.CallSub(cmdrefresh_click)

		F.Intrinsic.Control.EndSelect
		Gui.frmResched.lblStatus.Visible(False)
		Gui.frmResched.pbStatus.Visible(False)
	F.Intrinsic.Control.EndIf
	


F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdSched_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf


Program.Sub.cmdSched_Click.End

Program.Sub.cmdClearSel_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdClearSel_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)


	V.Local.iCnt.Declare(Long)
	V.Local.sPriority.Declare(String)
	V.Local.fSetup.Declare(Float)
	V.Local.fRuntime.Declare(Float)
	V.Local.dDueDate.Declare(Date)

	F.Intrinsic.Control.SelectCase(V.Screen.frmResched!tabResched.Tab)
		F.Intrinsic.Control.Case(0)
			F.Intrinsic.Control.If(V.DataTable.dtWC.Exists)
				F.Data.DataTable.SetValue("dtWC",-1,"Select",False)
				F.Data.DataTable.SetValue("dtWC",-1,"CurrentOp","")
			F.Intrinsic.Control.EndIf

			F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtWC.RowCount--,1)
				Gui.frmResched.GsGCWC.GetCellValue("gvWC",3,V.Local.iCnt,V.Local.sPriority)
				F.Data.DataTable.SetValue("dtWC",V.Local.iCnt,"PRIORITY2",V.Local.sPriority)
				Gui.frmResched.GsGCWC.GetCellValue("gvWC",12,V.Local.iCnt,V.Local.dDueDate)
				F.Data.DataTable.SetValue("dtWC",V.Local.iCnt,"DATE_DUE2",V.Local.dDueDate)
			F.Intrinsic.Control.Next(V.Local.iCnt)

		F.Intrinsic.Control.Case(1)
			F.Intrinsic.Control.If(V.DataTable.dtRouter.Exists)
				F.Data.DataTable.SetValue("dtRouter",-1,"Select",False)
			F.Intrinsic.Control.EndIf

		F.Intrinsic.Control.Case(2)
			F.Intrinsic.Control.If(V.DataTable.dtPart.Exists)
				F.Data.DataTable.SetValue("dtPart",-1,"Select",False)
			F.Intrinsic.Control.EndIf

			F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtPart.RowCount--,1)
				Gui.frmResched.GsGCPart.GetCellValue("gvPart",6,V.Local.iCnt,V.Local.fSetup)
				F.Data.DataTable.SetValue("dtPart",V.Local.iCnt,"SETUP2",V.Local.fSetup)
				Gui.frmResched.GsGCPart.GetCellValue("gvPart",8,V.Local.iCnt,V.Local.fRuntime)
				F.Data.DataTable.SetValue("dtPart",V.Local.iCnt,"RUNTIME2",V.Local.fRuntime)
			F.Intrinsic.Control.Next(V.Local.iCnt)

	F.Intrinsic.Control.EndSelect



F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdClearSel_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf


Program.Sub.cmdClearSel_Click.End

Program.Sub.cmdClearScr_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdClearScr_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)


	F.Intrinsic.Control.SelectCase(V.Screen.frmResched!tabResched.Tab)
		F.Intrinsic.Control.Case(0)
			F.Intrinsic.Control.If(V.DataTable.dtWC.Exists)
				Gui.frmResched.GsGCWC.ClearRows("gvWC")
				Gui.frmResched.ddlWC.Text("")
				Gui.frmResched.ddlWG.Text("")
				GUI.frmResched.txtDept.Text("")
				GUI.frmResched.ddlList.ClearItems
				V.Global.sWCdisplay.Set("")
				V.Global.sWGdisplay.Set("")
			F.Intrinsic.Control.Else
				Gui.frmResched.ddlWC.Text("")
				Gui.frmResched.ddlWG.Text("")
				GUI.frmResched.txtDept.Text("")
				GUI.frmResched.ddlList.ClearItems
				V.Global.sWCdisplay.Set("")
				V.Global.sWGdisplay.Set("")
			F.Intrinsic.Control.EndIf

		F.Intrinsic.Control.Case(1)
			F.Intrinsic.Control.If(V.DataTable.dtRouter.Exists)
				F.Data.DataTable.Close("dtRouter")
				Gui.frmResched.GsGCRouter.ClearRows("gvRouter")
				Gui.frmResched.txtRouter.Text("")
				Gui.frmResched.txtReplace.Text("")
				Gui.frmResched.lblRtrNote.Caption("***Jobs using the Current Router are going to be updated to use the New Router***")
				GUI.frmResched.txtDept.Text("")
			F.Intrinsic.Control.Else
				Gui.frmResched.txtRouter.Text("")
				Gui.frmResched.txtReplace.Text("")
				Gui.frmResched.lblRtrNote.Caption("***Jobs using the Current Router are going to be updated to use the New Router***")
				GUI.frmResched.txtDept.Text("")
			F.Intrinsic.Control.EndIf

		F.Intrinsic.Control.Case(2)
			F.Intrinsic.Control.If(V.DataTable.dtPart.Exists)
				Gui.frmResched.GsGCPart.ClearRows("gvPart")
				Gui.frmResched.txtPart.Text("")
				Gui.frmResched.txtLoc.Text("")
				Gui.frmResched.txtNewPart.Text("")
				Gui.frmResched.txtNewLoc.Text("")
				GUI.frmResched.txtDept.Text("")
			F.Intrinsic.Control.Else
				Gui.frmResched.txtPart.Text("")
				Gui.frmResched.txtLoc.Text("")
				Gui.frmResched.txtNewPart.Text("")
				Gui.frmResched.txtNewLoc.Text("")
				GUI.frmResched.txtDept.Text("")
			F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndSelect
	


F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdClearScr_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf


Program.Sub.cmdClearScr_Click.End

Program.Sub.cmdRefresh_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdRefresh_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)


	F.Intrinsic.Control.SelectCase(V.Screen.frmResched!tabResched.Tab)
		F.Intrinsic.Control.Case(0)
			F.Intrinsic.Control.If(V.DataTable.dtWC.Exists)
				Gui.frmResched.GsGCWC.Visible(False)
				F.Intrinsic.Control.CallSub(cmdDisplay_Click)
				Gui.frmResched.GsGCWC.Visible(True)
			f.Intrinsic.Control.EndIf

		F.Intrinsic.Control.Case(1)
			F.Intrinsic.Control.If(V.DataTable.dtRouter.Exists)
				Gui.frmResched.GsGCRouter.Visible(False)
				F.Intrinsic.Control.CallSub(LoadDTRouter)
				Gui.frmResched.GsGCRouter.Visible(True)
			F.Intrinsic.Control.EndIf

		F.Intrinsic.Control.Case(2)
			F.Intrinsic.Control.If(V.DataTable.dtPart.Exists)
				Gui.frmResched.GsGCPart.Visible(False)
				F.Intrinsic.Control.CallSub(LoadDTPart)
				Gui.frmResched.GsGCPart.Visible(True)
			F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.EndSelect



F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdRefresh_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf


Program.Sub.cmdRefresh_Click.End

Program.Sub.cmdExport_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdExport_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)


	V.Local.sFileExport.Declare(String)
	V.Local.bExcel.Declare(Boolean)
	V.Local.bFileLocked.Declare(Boolean)
	V.Local.sMsg.Declare(String)

	F.Automation.MSExcel.CheckPresence(V.Local.bExcel)

	F.Intrinsic.Control.SelectCase(V.Screen.frmResched!tabResched.Tab)
		F.Intrinsic.Control.Case(0)
			F.Intrinsic.Control.If(V.DataTable.dtWC.Exists)
				F.Intrinsic.Control.If(V.Local.bExcel)
					F.Intrinsic.String.Build("{0}\GAB_4617_WC_Export.xlsx",V.Caller.LocalGssTempDir,V.Local.sFileExport)
					F.Intrinsic.File.IsFileLocked(V.Local.sFileExport,V.Local.bFileLocked)
					F.Intrinsic.Control.If(V.Local.bFileLocked)
						F.Intrinsic.String.Build("File is already open. Please close and export again.{0}File: {1}",V.Ambient.NewLine,V.Local.sFileExport,V.Local.sMsg)
						F.Intrinsic.UI.Msgbox(V.Local.sMsg,"File In Use")
					F.Intrinsic.Control.Else
						Gui.frmResched.GsGCWC.Export(V.Local.sFileExport,"xlsx")
						F.Intrinsic.Task.ShellExec(0,"",V.Local.sFileExport,"","",1)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Build("{0}\GAB_4617_WC_Export.csv",V.Caller.LocalGssTempDir,V.Local.sFileExport)
					F.Intrinsic.File.IsFileLocked(V.Local.sFileExport,V.Local.bFileLocked)
					F.Intrinsic.Control.If(V.Local.bFileLocked)
						F.Intrinsic.String.Build("File is already open. Please close and export again.{0}File: {1}",V.Ambient.NewLine,V.Local.sFileExport,V.Local.sMsg)
						F.Intrinsic.UI.Msgbox(V.Local.sMsg,"File In Use")
					F.Intrinsic.Control.Else
						Gui.frmResched.GsGCWC.Export(V.Local.sFileExport,"csv")
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Task.ShellExec(0,"",V.Local.sFileExport,"","",1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf

		F.Intrinsic.Control.Case(1)
			F.Intrinsic.Control.If(V.DataTable.dtRouter.Exists)
				F.Intrinsic.Control.If(V.Local.bExcel)
					F.Intrinsic.String.Build("{0}\GAB_4617_Rtr_Export.xlsx",V.Caller.LocalGssTempDir,V.Local.sFileExport)
					F.Intrinsic.File.IsFileLocked(V.Local.sFileExport,V.Local.bFileLocked)
					F.Intrinsic.Control.If(V.Local.bFileLocked)
						F.Intrinsic.String.Build("File is already open. Please close and export again.{0}File: {1}",V.Ambient.NewLine,V.Local.sFileExport,V.Local.sMsg)
						F.Intrinsic.UI.Msgbox(V.Local.sMsg,"File In Use")
					F.Intrinsic.Control.Else
						Gui.frmResched.GsGCRouter.Export(V.Local.sFileExport,"xlsx")
						F.Intrinsic.Task.ShellExec(0,"",V.Local.sFileExport,"","",1)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Build("{0}\GAB_4617_Rtr_Export.csv",V.Caller.LocalGssTempDir,V.Local.sFileExport)
					F.Intrinsic.File.IsFileLocked(V.Local.sFileExport,V.Local.bFileLocked)
					F.Intrinsic.Control.If(V.Local.bFileLocked)
						F.Intrinsic.String.Build("File is already open. Please close and export again.{0}File: {1}",V.Ambient.NewLine,V.Local.sFileExport,V.Local.sMsg)
						F.Intrinsic.UI.Msgbox(V.Local.sMsg,"File In Use")
					F.Intrinsic.Control.Else
						Gui.frmResched.GsGCRouter.Export(V.Local.sFileExport,"csv")
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Task.ShellExec(0,"",V.Local.sFileExport,"","",1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf

		F.Intrinsic.Control.Case(2)
			F.Intrinsic.Control.If(V.DataTable.dtPart.Exists)
				F.Intrinsic.Control.If(V.Local.bExcel)
					F.Intrinsic.String.Build("{0}\GAB_4617_Part_Export.xlsx",V.Caller.LocalGssTempDir,V.Local.sFileExport)
					F.Intrinsic.File.IsFileLocked(V.Local.sFileExport,V.Local.bFileLocked)
					F.Intrinsic.Control.If(V.Local.bFileLocked)
						F.Intrinsic.String.Build("File is already open. Please close and export again.{0}File: {1}",V.Ambient.NewLine,V.Local.sFileExport,V.Local.sMsg)
						F.Intrinsic.UI.Msgbox(V.Local.sMsg,"File In Use")
					F.Intrinsic.Control.Else
						Gui.frmResched.GsGCPart.Export(V.Local.sFileExport,"xlsx")
						F.Intrinsic.Task.ShellExec(0,"",V.Local.sFileExport,"","",1)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Build("{0}\GAB_4617_Part_Export.csv",V.Caller.LocalGssTempDir,V.Local.sFileExport)
					F.Intrinsic.File.IsFileLocked(V.Local.sFileExport,V.Local.bFileLocked)
					F.Intrinsic.Control.If(V.Local.bFileLocked)
						F.Intrinsic.String.Build("File is already open. Please close and export again.{0}File: {1}",V.Ambient.NewLine,V.Local.sFileExport,V.Local.sMsg)
						F.Intrinsic.UI.Msgbox(V.Local.sMsg,"File In Use")
					F.Intrinsic.Control.Else
						Gui.frmResched.GsGCPart.Export(V.Local.sFileExport,"csv")
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Task.ShellExec(0,"",V.Local.sFileExport,"","",1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.EndSelect



F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdExport_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf


Program.Sub.cmdExport_Click.End

Program.Sub.cmdNew_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdNew_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)


	V.Local.iRowCnt.Declare(Long)
	V.Local.iRet.Declare(Long)
	V.Local.iRowCnt2.Declare(Long)

	F.ODBC.Connection!con.ExecuteAndReturn("SELECT COUNT(*) FROM JOB_HEADER;",V.Local.iRowCnt)
	F.Global.General.LaunchMenuTask(527,2,V.Local.iRet)
	F.ODBC.Connection!con.ExecuteAndReturn("SELECT COUNT(*) FROM JOB_HEADER;",V.Local.iRowCnt2)
	F.Intrinsic.Control.If(V.Local.iRowCnt,<>,V.Local.iRowCnt2)
		F.Intrinsic.Control.CallSub(cmdrefresh_click)
	F.Intrinsic.Control.EndIf



F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdNew_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf


Program.Sub.cmdNew_Click.End

Program.Sub.DisableControls.Start
F.Intrinsic.Control.SetErrorHandler("DisableControls_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)


	Gui.frmResched.frameButtons.Enabled(False)
	Gui.frmResched.frameSched.Enabled(False)
	Gui.frmResched.cmdClearScr.Enabled(False)	
	Gui.frmResched.cmdSched.Enabled(False)
	Gui.frmResched.cmdClearSel.Enabled(False)
	Gui.frmResched.cmdClearScr.Enabled(False)

	F.Intrinsic.Control.SelectCase(V.Screen.frmResched!tabResched.Tab)
		F.Intrinsic.Control.Case(0)
			Gui.frmResched.GsGCWC.Enabled(False)
			Gui.frmResched.optWC.Enabled(False)
			Gui.frmResched.optWG.Enabled(False)
			Gui.frmResched.ddlWC.Enabled(False)
			Gui.frmResched.ddlWG.Enabled(False)

		F.Intrinsic.Control.Case(1)
			Gui.frmResched.GsGCRouter.Enabled(False)
			Gui.frmResched.chkReplace.Enabled(False)
			Gui.frmResched.txtRouter.Enabled(False)
			Gui.frmResched.txtReplace.Enabled(False)
			Gui.frmResched.cmdRouter.Enabled(False)
			Gui.frmResched.cmdReplace.Enabled(False)

		F.Intrinsic.Control.Case(2)
			Gui.frmResched.txtPart.Enabled(False)
			Gui.frmResched.txtLoc.Enabled(False)
			Gui.frmResched.txtNewPart.Enabled(False)
			Gui.frmResched.txtNewLoc.Enabled(False)
			Gui.frmResched.cmdPart.Enabled(False)
			Gui.frmResched.cmdNewPart.Enabled(False)

	F.Intrinsic.Control.EndSelect



F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("DisableControls_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf


Program.Sub.DisableControls.End

Program.Sub.EnableControls.Start
F.Intrinsic.Control.SetErrorHandler("EnableControls_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)


	Gui.frmResched.frameButtons.Enabled(True)
	Gui.frmResched.frameSched.Enabled(True)
	Gui.frmResched.cmdClearScr.Enabled(True)	
	Gui.frmResched.cmdSched.Enabled(True)
	Gui.frmResched.cmdClearSel.Enabled(True)
	Gui.frmResched.cmdClearScr.Enabled(True)

	F.Intrinsic.Control.SelectCase(V.Screen.frmResched!tabResched.Tab)
		F.Intrinsic.Control.Case(0)
			Gui.frmResched.GsGCWC.Enabled(True)
			Gui.frmResched.optWC.Enabled(True)
			Gui.frmResched.optWG.Enabled(True)
			Gui.frmResched.ddlWC.Enabled(True)
			Gui.frmResched.ddlWG.Enabled(True)

		F.Intrinsic.Control.Case(1)
			Gui.frmResched.GsGCRouter.Enabled(True)
			Gui.frmResched.chkReplace.Enabled(True)
			Gui.frmResched.txtRouter.Enabled(True)
			Gui.frmResched.txtReplace.Enabled(True)
			Gui.frmResched.cmdRouter.Enabled(True)
			Gui.frmResched.cmdReplace.Enabled(True)

		F.Intrinsic.Control.Case(2)
			Gui.frmResched.txtPart.Enabled(True)
			Gui.frmResched.txtLoc.Enabled(True)
			Gui.frmResched.txtNewPart.Enabled(True)
			Gui.frmResched.txtNewLoc.Enabled(True)
			Gui.frmResched.cmdPart.Enabled(True)
			Gui.frmResched.cmdNewPart.Enabled(True)

	F.Intrinsic.Control.EndSelect
	


F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("EnableControls_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf


Program.Sub.EnableControls.End

Program.Sub.LoadDDLists.Start
F.Intrinsic.Control.SetErrorHandler("LoadDDLists_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

	V.Local.iCnt.Declare(Long)
	v.Local.ssql.Declare(String)
	f.Intrinsic.Control.If(v.Screen.frmResched!txtDept.Text,=,"")
		F.ODBC.Connection!con.OpenRecordsetRO("rstDdlWC","SELECT MACHINE FROM WORKCENTERS ORDER BY MACHINE;")
	f.Intrinsic.Control.Else
		f.Intrinsic.Control.string.build("SELECT MACHINE FROM WORKCENTERS where WC_DEPT = '{0}' ORDER BY MACHINE",v.Screen.frmResched!!txtDept.text,v.Local.ssql)
		F.ODBC.Connection!con.OpenRecordsetRO("rstDdlWC",v.Local.ssql)
	f.Intrinsic.Control.EndIf
	F.Intrinsic.Control.DoUntil(V.ODBC.con!rstDdlWC.EOF,=,True)
		Gui.frmResched.ddlWC.AddItem(V.ODBC.con!rstDdlWC.FieldValTrim!MACHINE,V.Local.iCnt)
		F.Intrinsic.Control.If(V.ODBC.con!rstDdlWC.EOF)
			F.Intrinsic.String.Build("{0}{1}",V.Global.sWCList,V.ODBC.con!rstDdlWC.FieldValTrim!MACHINE,V.Global.sWCList)
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.If(V.Global.sWCList,=,"")
				V.Global.sWCList.Set(V.ODBC.con!rstDdlWC.FieldValTrim!MACHINE)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("{0}*!*{1}",V.Global.sWCList,V.ODBC.con!rstDdlWC.FieldValTrim!MACHINE,V.Global.sWCList)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Math.Add(V.Local.iCnt,1,V.Local.iCnt)
	F.ODBC.con!rstDdlWC.MoveNext
	F.Intrinsic.Control.Loop

	F.ODBC.Connection!con.OpenRecordsetRO("rstDdlWG","SELECT WORK_GROUP,WORK_GROUP FROM WORKGROUP_HEAD;")
	F.Intrinsic.Control.DoUntil(V.ODBC.con!rstDdlWG.EOF,=,True)
		Gui.frmResched.ddlWG.AddItem(V.ODBC.con!rstDdlWG.FieldValTrim!WORK_GROUP,V.Local.iCnt)
		F.Intrinsic.Math.Add(V.Local.iCnt,1,V.Local.iCnt)
	F.ODBC.con!rstDdlWG.MoveNext
	F.Intrinsic.Control.Loop
	


F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("LoadDDLists_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf


Program.Sub.LoadDDLists.End

Program.Sub.optWC_Click.Start
F.Intrinsic.Control.SetErrorHandler("optWC_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)


	Gui.frmResched.ddlWC.Visible(True)
	Gui.frmResched.ddlWG.Visible(False)
	Gui.frmResched.ddlWG.Text("")
	Gui.frmResched.ddlWG.Text("")



F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("optWC_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf


Program.Sub.optWC_Click.End

Program.Sub.optWG_Click.Start
F.Intrinsic.Control.SetErrorHandler("optWG_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)


	Gui.frmResched.ddlWC.Visible(False)
	Gui.frmResched.ddlWG.Visible(True)
	Gui.frmResched.ddlWG.Text("")
	Gui.frmResched.ddlWG.Text("")



F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("optWG_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf


Program.Sub.optWG_Click.End

Program.Sub.ddlWC_Click.Start
F.Intrinsic.Control.SetErrorHandler("ddlWC_Click_Err")
F.Intrinsic.Control.ClearErrors
V.Local.sError.Declare(String)


'this will add WC and WG to the ddl List
F.Intrinsic.Control.If(V.Screen.frmResched!optWC.Value)
	GUI.frmResched.ddlList.AddItem(V.Screen.frmResched!ddlWC.Text)
	GUI.frmResched.ddlList.Text(V.Screen.frmResched!ddlWC.Text)
	Function.Intrinsic.Control.If(V.Global.sWCdisplay, <>, "")
	F.Intrinsic.String.Build("{0}','{1}", V.Global.sWCdisplay, V.Screen.frmResched!ddlWC.Text,V.Global.sWCdisplay)
	Function.Intrinsic.Control.Else
		V.Global.sWCdisplay.Set(V.Screen.frmResched!ddlWC.Text)
	Function.Intrinsic.Control.EndIf
Function.Intrinsic.Control.Else
	GUI.frmResched.ddlList.AddItem(V.Screen.frmResched!ddlWG.Text)
	GUI.frmResched.ddlList.Text(V.Screen.frmResched!ddlWG.Text)
	Function.Intrinsic.Control.If(V.Global.sWGdisplay, <>, "")
	F.Intrinsic.String.Build("{0}','{1}", V.Global.sWGdisplay, V.Screen.frmResched!ddlWG.Text,V.Global.sWGdisplay)
	Function.Intrinsic.Control.Else
		V.Global.sWGdisplay.Set(V.Screen.frmResched!ddlWG.Text)
	Function.Intrinsic.Control.EndIf
Function.Intrinsic.Control.EndIf


F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("ddlWC_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf


Program.Sub.ddlWC_Click.End

Program.Sub.LoadGVWC.Start
F.Intrinsic.Control.SetErrorHandler("LoadGVWC_Err")
F.Intrinsic.Control.ClearErrors
V.Local.sError.Declare(String)

	V.Local.iCnt.Declare(Long)

	Gui.frmResched.GsGCWC.AddGridViewFromDataTable("gvWC","dtWC")

	Gui.frmResched.GsGCWC.SetGridViewProperty("gvWC","MultiSelect",False)
	Gui.frmResched.GsGCWC.SetGridViewProperty("gvWC","AllowSort",True)
	Gui.frmResched.GsGCWC.SetGridViewProperty("gvWC","AllowFilter",True)
	Gui.frmResched.GsGCWC.SetGridViewProperty("gvWC","showdetailtabs",False)
	Gui.frmResched.GsGCWC.SetGridViewProperty("gvWC","showgrouppanel",True)
	Gui.frmResched.GsGCWC.SetGridViewProperty("gvWC","AllowColumnResizing",False)

	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","JOB","Visible",False)
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","SFX","Visible",False)
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","PRIORITY","Visible",False)
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","DATE_START","Visible",False)
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","DATE_DUE","Visible",False)
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","PrevSeq","Visible",False)
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","PrevClsd","Visible",False)
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","CurrentOp","Visible",True)


	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","Select","Fixed","Left")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","WO","Fixed","Left")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","PRIORITY2","Fixed","Left")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","SEQ","Fixed","Left")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","WC","Fixed","Left")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","CurrentOp","Fixed","Left")

	'added by WAW
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","NextOp","Fixed","Left")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","Released","Fixed","Left")


	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","Select","VisibleIndex","0")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","WO","VisibleIndex","1")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","Released","VisibleIndex","2")
'	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","PRIORITY2","VisibleIndex","2")
'	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","SEQ","VisibleIndex","3")
'	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","WC","VisibleIndex","4")
'	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","CurrentOp","VisibleIndex","5")
'	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","DEPT","VisibleIndex","6")
'	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","PART","VisibleIndex","7")
'	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","PART_DESCRIPTION","VisibleIndex","8")
'	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","STARTDATE","VisibleIndex","9")
'	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","DUEDATE","VisibleIndex","10")
'	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","DATE_DUE2","VisibleIndex","11")
'	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","SCHED_DATE","VisibleIndex","12")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","PRIORITY2","VisibleIndex","3")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","SEQ","VisibleIndex","4")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","WC","VisibleIndex","5")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","CurrentOp","VisibleIndex","6")

	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","DEPT","VisibleIndex","7")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","PART","VisibleIndex","8")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","PART_DESCRIPTION","VisibleIndex","9")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","STARTDATE","VisibleIndex","10")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","DUEDATE","VisibleIndex","11")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","DATE_DUE2","VisibleIndex","12")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","SCHED_DATE","VisibleIndex","13")


'	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","EST_HRS","VisibleIndex","13")
'	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","ACT_HRS","VisibleIndex","14")
'	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","REM_HRS","VisibleIndex","15")
'	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","EST_QTY","VisibleIndex","16")
'	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","REM_QTY","VisibleIndex","17")
'	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","PrevQty","VisibleIndex","18")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","EST_HRS","VisibleIndex","16")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","ACT_HRS","VisibleIndex","17")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","REM_HRS","VisibleIndex","18")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","EST_QTY","VisibleIndex","19")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","REM_QTY","VisibleIndex","20")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","PrevQty","VisibleIndex","21")

	'added by WAW
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","NextOp","VisibleIndex","22")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","DaysLate","VisibleIndex","14")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","EstStart","VisibleIndex","15")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","EstEnd","VisibleIndex","16")

	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","Select","Caption","Select ")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","WO","Caption","Work Order")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","PRIORITY2","Caption","Priority ")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","SEQ","Caption","Seq. ")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","WC","Caption","Current WC")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","CurrentOp","Caption","Current Op")

	'added by WAW
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","NextOp","Caption","Next Op")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","DaysLate","Caption","Days Late")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","EstStart","Caption","Est. Start")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","EstEnd","Caption","Est. End")

	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","Released","Caption","Released")

	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","DEPT","Caption","Dept")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","PART","Caption","Part ")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","PART_DESCRIPTION","Caption","Description")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","STARTDATE","Caption","Seq. Start Date")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","DUEDATE","Caption","Seq. Due Date")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","DATE_DUE2","Caption","WO Due Date")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","SCHED_DATE","Caption","WO Sched. Due Date")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","EST_HRS","Caption","Est. Hrs.")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","ACT_HRS","Caption","Act. Hrs.")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","REM_HRS","Caption","Rem. Hrs.")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","EST_QTY","Caption","Est. Qty.")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","REM_QTY","Caption","Rem. Qty.")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","PrevQty","Caption","Prev. Compl. Qty.")

	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","Select","MinWidth","10")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","WO","MinWidth","85")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","PRIORITY2","MinWidth","30")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","SEQ","MinWidth","75")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","WC","MinWidth","75")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","CurrentOp","MinWidth","75")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","DEPT","MinWidth","60")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","PART","MinWidth","120")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","PART_DESCRIPTION","MinWidth","150")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","STARTDATE","MinWidth","90")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","DUEDATE","MinWidth","90")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","DATE_DUE2","MinWidth","90")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","SCHED_DATE","MinWidth","110")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","EST_HRS","MinWidth","80")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","ACT_HRS","MinWidth","80")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","REM_HRS","MinWidth","80")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","EST_QTY","MinWidth","80")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","REM_QTY","MinWidth","80")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","PrevQty","MinWidth","95")

	'added by WAW
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","NextOp","MinWidth","80")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","DaysLate","MinWidth","90")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","Released","MinWidth","10")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","EstStart","MinWidth","150")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","EstEnd","MinWidth","150")		

	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","SEQ","DisplayCustomNumeric","000000")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","EST_HRS","DisplayCustomNumeric","#,###,##0.0000")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","ACT_HRS","DisplayCustomNumeric","#,###,##0.0000")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","REM_HRS","DisplayCustomNumeric","#,###,##0.0000")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","EST_QTY","DisplayCustomNumeric","#,###,##0.0000")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","REM_QTY","DisplayCustomNumeric","#,###,##0.0000")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","PrevQty","DisplayCustomNumeric","#,###,##0.0000")

	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","Select","AllowEdit",False)
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","Select","ReadOnly",True)
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","WO","AllowEdit",False)
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","WO","ReadOnly",True)
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","SEQ","AllowEdit",False)
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","SEQ","ReadOnly",True)
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","WC","AllowEdit",False)
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","WC","ReadOnly",True)
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","DEPT","AllowEdit",False)
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","DEPT","ReadOnly",True)
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","PART","AllowEdit",False)
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","PART","ReadOnly",True)
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","PART_DESCRIPTION","AllowEdit",False)
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","PART_DESCRIPTION","ReadOnly",True)
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","STARTDATE","AllowEdit",False)
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","STARTDATE","ReadOnly",True)
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","DUEDATE","AllowEdit",False)
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","DUEDATE","ReadOnly",True)
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","SCHED_DATE","AllowEdit",False)
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","SCHED_DATE","ReadOnly",True)
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","EST_HRS","AllowEdit",False)
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","EST_HRS","ReadOnly",True)
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","ACT_HRS","AllowEdit",False)
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","ACT_HRS","ReadOnly",True)
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","REM_HRS","AllowEdit",False)
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","REM_HRS","ReadOnly",True)
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","EST_QTY","AllowEdit",False)
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","EST_QTY","ReadOnly",True)
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","REM_QTY","AllowEdit",False)
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","REM_QTY","ReadOnly",True)
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","PrevQty","AllowEdit",False)
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","PrevQty","ReadOnly",True)

	'added by WAW
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","NextOp","AllowEdit",False)
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","NextOp","ReadOnly",True)

	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","DaysLate","AllowEdit",False)
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","DaysLate","ReadOnly",True)

	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","Select","HeaderHAlignment","Center")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","Select","CellHAlignment","Center")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","WO","HeaderHAlignment","Center")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","WO","CellHAlignment","Center")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","PRIORITY2","HeaderHAlignment","Center")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","PRIORITY2","CellHAlignment","Center")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","SEQ","HeaderHAlignment","Center")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","SEQ","CellHAlignment","Center")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","DEPT","HeaderHAlignment","Center")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","DEPT","CellHAlignment","Center")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","STARTDATE","HeaderHAlignment","Center")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","STARTDATE","CellHAlignment","Center")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","DUEDATE","HeaderHAlignment","Center")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","DUEDATE","CellHAlignment","Center")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","DATE_DUE2","HeaderHAlignment","Center")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","DATE_DUE2","CellHAlignment","Center")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","SCHED_DATE","HeaderHAlignment","Center")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","SCHED_DATE","CellHAlignment","Center")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","EST_HRS","HeaderHAlignment","Far")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","EST_HRS","CellHAlignment","Far")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","ACT_HRS","HeaderHAlignment","Far")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","ACT_HRS","CellHAlignment","Far")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","REM_HRS","HeaderHAlignment","Far")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","REM_HRS","CellHAlignment","Far")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","EST_QTY","HeaderHAlignment","Far")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","EST_QTY","CellHAlignment","Far")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","REM_QTY","HeaderHAlignment","Far")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","REM_QTY","CellHAlignment","Far")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","PrevQty","HeaderHAlignment","Far")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","PrevQty","CellHAlignment","Far")

	'added by WAW
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","DaysLate","HeaderHAlignment","Center")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","NextOp","CellHAlignment","Center")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","Released","HeaderHAlignment","Center")

	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","WO","CellForeColor","Blue")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","WC","CellTrimming","Character")

'	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","STARTDATE","DisplayCustomDatetime","d")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","DUEDATE","DisplayCustomDatetime","d")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","DATE_DUE2","DisplayCustomDatetime","d")
	Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","SCHED_DATE","DisplayCustomDatetime","d")

	F.Intrinsic.Control.If(V.Global.bEdit)
		Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","PRIORITY2","AllowEdit",True)
		Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","PRIORITY2","ReadOnly",False)
		Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","CurrentOp","AllowEdit",True)
		Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","CurrentOp","ReadOnly",False)

		'added by waw 
'		gui.frmResched.GsGCWC.SetColumnProperty("gvWC","NextOp","AllowEdit",True)
'		Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","NextOp","ReadOnly",False)

		Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","DATE_DUE2","AllowEdit",True)
		Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","DATE_DUE2","ReadOnly",False)
		Gui.frmResched.GsGCWC.ColumnEdit("gvWC","CurrentOp","Dropdownlist",V.Global.sWCList)
		Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","PRIORITY2","CellBackColor","LightYellow")
		Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","CurrentOp","CellBackColor","LightYellow")
		Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","DATE_DUE2","CellBackColor","LightYellow")
	F.Intrinsic.Control.Else
		Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","PRIORITY2","AllowEdit",False)
		Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","PRIORITY2","ReadOnly",True)
		Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","CurrentOp","AllowEdit",False)
		Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","CurrentOp","ReadOnly",True)
		Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","DATE_DUE2","AllowEdit",False)
		Gui.frmResched.GsGCWC.SetColumnProperty("gvWC","DATE_DUE2","ReadOnly",True)
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtWC.RowCount--,1)
		Gui.frmResched.GsGCWC.SetRowAppearance("gvWC",V.Local.iCnt,"BackColor","WhiteSmoke")

		F.Intrinsic.Control.If(V.DataTable.dtWC(V.Local.iCnt).SCHED_DATE!FieldVal,>,V.DataTable.dtWC(V.Local.iCnt).DATE_DUE!FieldVal)
			Gui.frmResched.GsGCWC.SetRowAppearance("gvWC",V.Local.iCnt,"BackColor","Pink")
		F.Intrinsic.Control.EndIf

		F.Intrinsic.Control.If(V.DataTable.dtWC(V.Local.iCnt).STARTDATE!FieldVal,<>,"")
			F.Intrinsic.Control.If(V.DataTable.dtWC(V.Local.iCnt).STARTDATE!FieldVal,<,V.Ambient.Date)
				Gui.frmResched.GsGCWC.SetRowAppearance("gvWC",V.Local.iCnt,"BackColor","Pink")
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf

		F.Intrinsic.Control.If(V.DataTable.dtWC(V.Local.iCnt).PrevQty!FieldVal,=,V.DataTable.dtWC(V.Local.iCnt).EST_QTY!FieldVal)
			Gui.frmResched.GsGCWC.SetCellAppearance("gvWC",0,V.Local.iCnt,"HAlignment","Center")
			Gui.frmResched.GsGCWC.SetCellAppearance("gvWC",0,V.Local.iCnt,"BackColor","LightGreen")
			Gui.frmResched.GsGCWC.SetCellAppearance("gvWC",0,V.Local.iCnt,"ForeColor","Blue")
		F.Intrinsic.Control.EndIf

		F.Intrinsic.Control.If(V.DataTable.dtWC(V.Local.iCnt).PrevClsd!FieldVal,=,"Y")
			F.Intrinsic.Control.If(V.DataTable.dtWC(V.Local.iCnt).PrevQty!FieldVal,=,V.DataTable.dtWC(V.Local.iCnt).EST_QTY!FieldVal)
				Gui.frmResched.GsGCWC.SetCellAppearance("gvWC",0,V.Local.iCnt,"HAlignment","Center")
				Gui.frmResched.GsGCWC.SetCellAppearance("gvWC",0,V.Local.iCnt,"BackColor","LightGreen")
				Gui.frmResched.GsGCWC.SetCellAppearance("gvWC",0,V.Local.iCnt,"ForeColor","Blue")
			F.Intrinsic.Control.ElseIf(V.DataTable.dtWC(V.Local.iCnt).PrevQty!FieldVal,>,V.DataTable.dtWC(V.Local.iCnt).EST_QTY!FieldVal)
				Gui.frmResched.GsGCWC.SetCellAppearance("gvWC",0,V.Local.iCnt,"HAlignment","Center")
				Gui.frmResched.GsGCWC.SetCellAppearance("gvWC",0,V.Local.iCnt,"BackColor","LightSalmon")
				Gui.frmResched.GsGCWC.SetCellAppearance("gvWC",0,V.Local.iCnt,"ForeColor","Blue")
			F.Intrinsic.Control.ElseIf(V.DataTable.dtWC(V.Local.iCnt).PrevQty!FieldVal,<,V.DataTable.dtWC(V.Local.iCnt).EST_QTY!FieldVal)
				Gui.frmResched.GsGCWC.SetCellAppearance("gvWC",0,V.Local.iCnt,"HAlignment","Center")
				Gui.frmResched.GsGCWC.SetCellAppearance("gvWC",0,V.Local.iCnt,"BackColor","LightSalmon")
				Gui.frmResched.GsGCWC.SetCellAppearance("gvWC",0,V.Local.iCnt,"ForeColor","Blue")
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf

		F.Intrinsic.Control.If(V.DataTable.dtWC(V.Local.iCnt).PrevSeq!FieldVal,=,"")
			Gui.frmResched.GsGCWC.SetCellAppearance("gvWC",0,V.Local.iCnt,"HAlignment","Center")
			Gui.frmResched.GsGCWC.SetCellAppearance("gvWC",0,V.Local.iCnt,"BackColor","LightGreen")
			Gui.frmResched.GsGCWC.SetCellAppearance("gvWC",0,V.Local.iCnt,"ForeColor","Blue")
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(v.Local.iCnt)

	Gui.frmResched.GsGCWC.MainView("gvWC")

	F.Intrinsic.Control.CallSub(loadtotals,"Filter","")

F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.Label("LoadGVWC_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf
Program.Sub.LoadGVWC.End

Program.Sub.GsGCWC_CellValueChanged.Start
F.Intrinsic.Control.SetErrorHandler("GsGCWC_CellValueChanged_Err")
F.Intrinsic.Control.ClearErrors
V.Local.sError.Declare(String)

	V.Local.sPriority.Declare(String)
	V.Local.sNewPriority.Declare(String)
	V.Local.sWC.Declare(String)
	V.Local.sCurrentOp.Declare(String)
	V.Local.dDueDate.Declare(Date)
	V.Local.dNewDueDate.Declare(Date)

	F.Intrinsic.Control.SelectCase(V.Args.Column)
		F.Intrinsic.Control.Case("PRIORITY2")
			Gui.frmResched.GsGCWC.GetCellValue("gvWC",3,V.Args.RowIndex,V.Local.sPriority)
			F.Intrinsic.String.Format(V.Args.Value,"000",V.Local.sNewPriority)
			F.Intrinsic.String.Right(V.Local.sNewPriority,3,V.Local.sNewPriority)
			F.Data.DataTable.SetValue("dtWC",V.Args.RowIndex,"PRIORITY2",V.Local.sNewPriority)
			F.Intrinsic.Control.If(V.Local.sNewPriority.Trim,<>,V.Local.sPriority.Trim)
				F.Data.DataTable.SetValue("dtWC",V.Args.RowIndex,"Select",True)
			F.Intrinsic.Control.Else
				F.Data.DataTable.SetValue("dtWC",V.Args.RowIndex,"Select",False)
			F.Intrinsic.Control.EndIf

		F.Intrinsic.Control.Case("CurrentOp")
			Gui.frmResched.GsGCWC.GetCellValue("gvWC",6,V.Args.RowIndex,V.Local.sWC)
			V.Local.sCurrentOp.Set(V.Args.Value)
			F.Intrinsic.Control.If(V.Local.sCurrentOp.Trim,<>,V.Local.sWC.Trim)
				F.Data.DataTable.SetValue("dtWC",V.Args.RowIndex,"Select",True)
			F.Intrinsic.Control.Else
				F.Data.DataTable.SetValue("dtWC",V.Args.RowIndex,"Select",False)
			F.Intrinsic.Control.EndIf

		F.Intrinsic.Control.Case("DATE_DUE2")
			Gui.frmResched.GsGCWC.GetCellValue("gvWC",12,V.Args.RowIndex,V.Local.dDueDate)
			V.Local.dNewDueDate.Set(V.Args.Value)
			F.Intrinsic.Control.If(V.Local.dNewDueDate,<>,V.Local.dDueDate)
				F.Data.DataTable.SetValue("dtWC",V.Args.RowIndex,"Select",True)
			F.Intrinsic.Control.Else
				F.Data.DataTable.SetValue("dtWC",V.Args.RowIndex,"Select",False)
			F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndSelect

F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.Label("GsGCWC_CellValueChanged_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf
Program.Sub.GsGCWC_CellValueChanged.End

Program.Sub.GsGCWC_RowCellClick.Start
F.Intrinsic.Control.SetErrorHandler("GsGCWC_RowCellClick_Err")
F.Intrinsic.Control.ClearErrors
V.Local.sError.Declare(String)

	V.Local.sJob.Declare(String)
	V.Local.sSuffix.Declare(String)
	V.Local.sParams.Declare(String)
	v.Local.brel.Declare(boolean)
	v.Local.ssql.Declare(String)

Gui.frmResched.GsGCWC.GetCellValue("gvWC",1,V.Args.RowIndex,V.Local.sJob)
Gui.frmResched.GsGCWC.GetCellValue("gvWC",2,V.Args.RowIndex,V.Local.sSuffix)

F.Intrinsic.Control.SelectCase(V.Args.Column)
	F.Intrinsic.Control.Case("WO")
		F.Intrinsic.Control.If(V.Global.bEdit)
			F.Intrinsic.String.Build("{0}!*!{1}!*!O",V.Local.sJob,V.Local.sSuffix,V.Local.sParams)
			F.Intrinsic.Control.CallSub(disablecontrols)
			F.Global.General.CallWrapperSync(2009,V.Local.sParams)
			F.Intrinsic.Control.CallSub(enablecontrols)
		F.Intrinsic.Control.Else
			F.Intrinsic.String.Build("7!*!{0}!*!{1}!*!A",V.Local.sJob,V.Local.sSuffix,V.Local.sParams)
			F.Intrinsic.Control.CallSub(disablecontrols)
			F.Global.General.CallWrapperSync(450000,V.Local.sParams)
			F.Intrinsic.Control.CallSub(enablecontrols)
		F.Intrinsic.Control.EndIf
	f.Intrinsic.Control.Case("Released")
	f.Intrinsic.Control.If(v.Global.bEdit)
		F.Intrinsic.Control.If(V.Args.CellValue,=,False)
			F.Intrinsic.String.Build("UPDATE JOB_HEADER SET FLAG_WO_PRTD = CASE WHEN FLAG_WO_PRTD = '' Then 'X' WHEN FLAG_WO_PRTD = 'Y' Then 'R' END WHERE JOB = '{0}' AND SUFFIX = '{1}'",V.Local.sJob,V.Local.sSuf,V.Local.sSQL)
			F.ODBC.Connection!con.Execute(V.Local.sSQL)
			V.Local.bRel.Set(True)
			Gui.frmResched.GsGCWC.SetCellValue("gvWc",1,V.Args.RowIndex,True)
		F.Intrinsic.Control.Else
			F.Intrinsic.String.Build("UPDATE JOB_HEADER SET FLAG_WO_PRTD = CASE WHEN FLAG_WO_PRTD = 'X' Then '' WHEN FLAG_WO_PRTD = 'R' Then 'Y' END WHERE JOB = '{0}' AND SUFFIX = '{1}'",V.Local.sJob,V.Local.sSuf,V.Local.sSQL)
			F.ODBC.Connection!con.Execute(V.Local.sSQL)
			V.Local.bRel.Set(False)
			Gui.frmResched.GsGCWC.SetCellValue("gvWc",1,V.Args.RowIndex,False)
		F.Intrinsic.Control.EndIf
	f.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndSelect

F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.Label("GsGCWC_RowCellClick_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf
Program.Sub.GsGCWC_RowCellClick.End

Program.Sub.GsGCWC_ColumnFilterChanged.Start
F.Intrinsic.Control.SetErrorHandler("GsGCWC_ColumnFilterChanged_Err")
F.Intrinsic.Control.ClearErrors
V.Local.sError.Declare(String)

	V.Local.bFilter.Declare	(Boolean)
	V.Local.sFilter.Declare(String)
	V.Local.sInvalid.Declare(String)
	V.Local.bRet.Declare(Boolean)
	V.Local.iCnt.Declare(Long)
	V.Local.iCounter.Declare(Long,0)
	V.Local.sMsg.Declare(String)

	F.Intrinsic.String.Split("StartsWith*!*Between*!*Contains*!*EndsWith*!*IsNullOrEmpty*!*?*!*IsOutlookInterval","*!*",V.Local.sInvalid)
	F.Intrinsic.String.IsNullOrWhiteSpace(V.Args.ActiveFilterExpression,V.Local.bFilter)
	Function.Intrinsic.Control.If(V.Local.bFilter,=,True)
		F.Intrinsic.Control.CallSub(loadtotals,"Filter","")
	Function.Intrinsic.Control.Else
		F.Intrinsic.String.Replace(V.Args.ActiveFilterExpression,"[","",V.Local.sFilter)
		F.Intrinsic.String.Replace(V.Local.sFilter,"]","",V.Local.sFilter)

		F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.sInvalid.UBound,1)
			F.Intrinsic.String.IsInString(V.Local.sFilter,V.Local.sInvalid(V.Local.iCnt),False,V.Local.bRet)
			F.Intrinsic.Control.If(V.Local.bRet,=,True)
				F.Intrinsic.Math.Add(V.Local.iCounter,1,V.Local.iCounter)
			F.Intrinsic.Control.endif
		F.Intrinsic.Control.Next(V.Local.iCnt)

		F.Intrinsic.Control.If(V.Local.iCounter,=,1)
			Function.Intrinsic.String.Build("Grid will be filtered, but totals will not be recalculated, because one of the filters entered is an invalid filter for recalculating totals.{0}{0}Invalid Filters for recalculating totals:{0}- Is between{0}- Is not between{0}- Contains{0}- Does not contain{0}- Beings with{0}- Ends with{0}- Is blank{0}- Is not blank{0}- ?{0}- Calendar Checkboxes",V.Ambient.NewLine,V.Local.sMsg)
			Function.Intrinsic.UI.Msgbox(V.Local.sMsg,"Filter Validation")
		F.Intrinsic.Control.ElseIf(V.Local.iCounter,>,1)
			Function.Intrinsic.String.Build("Grid will be filtered, but totals will not be recalculated, because more than one filter entered is an invalid filter for recalculating totals.{0}{0}Invalid Filters for recalculating totals:{0}- Is between{0}- Is not between{0}- Contains{0}- Does not contain{0}- Beings with{0}- Ends with{0}- Is blank{0}- Is not blank{0}- ?{0}- Calendar Checkboxes",V.Ambient.NewLine,V.Local.sMsg)
			Function.Intrinsic.UI.Msgbox(V.Local.sMsg,"Filter Validation")
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.CallSub(loadtotals,"Filter",V.Local.sFilter)
		F.Intrinsic.Control.EndIf
	Function.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.Label("GsGCWC_ColumnFilterChanged_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf
Program.Sub.GsGCWC_ColumnFilterChanged.End

Program.Sub.LoadTotals.Start
F.Intrinsic.Control.SetErrorHandler("LoadTotals_Err")
F.Intrinsic.Control.ClearErrors
V.Local.sError.Declare(String)

	V.Local.fEstHrs.Declare(Float)
	V.Local.sEstHrs.Declare(String)
	V.Local.fActHrs.Declare(Float)
	V.Local.sActHrs.Declare(String)
	V.Local.fRemHrs.Declare(Float)
	V.Local.sRemHrs.Declare(String)

	F.Data.DataTable.Compute("dtWC","SUM(EST_HRS)",V.Args.Filter,V.Local.fEstHrs)
	F.Data.DataTable.Compute("dtWC","SUM(ACT_HRS)",V.Args.Filter,V.Local.fActHrs)
	F.Data.DataTable.Compute("dtWC","SUM(REM_HRS)",V.Args.Filter,V.Local.fRemHrs)
	F.Intrinsic.String.Format(V.Local.fEstHrs,"#,###,###,##0.00",V.Local.sEstHrs)
	Gui.frmResched.txtEst.Text(V.Local.sEstHrs)
	F.Intrinsic.String.Format(V.Local.fActHrs,"#,###,###,##0.00",V.Local.sActHrs)
	Gui.frmResched.txtAct.Text(V.Local.sActHrs)
	F.Intrinsic.String.Format(V.Local.fRemHrs,"#,###,###,##0.00",V.Local.sRemHrs)
	Gui.frmResched.txtRem.Text(V.Local.sRemHrs)

F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.Label("LoadTotals_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf
Program.Sub.LoadTotals.End

Program.Sub.LoadTextBoxes.Start
F.Intrinsic.Control.SetErrorHandler("LoadTextBoxes_Err")
F.Intrinsic.Control.ClearErrors
V.Local.sError.Declare(String)

	V.Local.sFile.Declare(String)
	V.Local.bFile.Declare(Boolean)

	F.Intrinsic.String.Build("{0}\GAB_4617_PreLoad.do",V.Caller.GasDir,V.Local.sFile)
	F.Intrinsic.File.Exists(V.Local.sFile,V.Local.bFile)
	F.Intrinsic.Control.If(V.Local.bFile,=,False)	
		F.Data.Dictionary.CreateFromSQL("dicRouter","con","SELECT ROUTER,ROUTER FROM ROUTER_XREF ORDER BY ROUTER;")
		Gui.frmResched.txtRouter.AddAutoCompleteItem("dicRouter","Dictionary")
		Gui.frmResched.txtReplace.AddAutoCompleteItem("dicRouter","Dictionary")

	'	F.Data.Dictionary.CreateFromSQL("dicPart","con","SELECT DISTINCT PART,PART FROM INVENTORY_MSTR;")
	'	F.Data.Dictionary.CreateFromSQL("dicLoc","con","SELECT DISTINCT LOCATION,LOCATION FROM INVENTORY_MSTR;")
	'	Gui.frmResched.txtPart.AddAutoCompleteItem("dicPart","Dictionary")
	'	Gui.frmResched.txtNewPart.AddAutoCompleteItem("dicPart","Dictionary")
	'	Gui.frmResched.txtLoc.AddAutoCompleteItem("dicLoc","Dictionary")
	'	Gui.frmResched.txtNewLoc.AddAutoCompleteItem("dicLoc","Dictionary")
		Gui.frmResched.txtPart.Enabled(False)
		Gui.frmResched.txtLoc.Enabled(False)
		Gui.frmResched.txtNewPart.Enabled(False)
		Gui.frmResched.txtNewLoc.Enabled(False)
	F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.Label("LoadTextBoxes_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf
Program.Sub.LoadTextBoxes.End

Program.Sub.chkReplace_Click.Start
F.Intrinsic.Control.SetErrorHandler("chkReplace_Click_Err")
F.Intrinsic.Control.ClearErrors
V.Local.sError.Declare(String)
	F.Intrinsic.Control.If(V.Screen.frmResched!chkReplace.Value,=,1)
		Gui.frmResched.lblRouter.Caption("Current Router")
		Gui.frmResched.lblReplace.Visible(True)
		Gui.frmResched.txtReplace.Visible(True)
		Gui.frmResched.cmdReplace.Visible(True)
		Gui.frmResched.lblRtrNote.Visible(True)
	F.Intrinsic.Control.Else
		Gui.frmResched.lblRouter.Caption("Router")
		Gui.frmResched.lblReplace.Visible(False)
		Gui.frmResched.txtReplace.Visible(False)
		Gui.frmResched.txtReplace.Text("")
		Gui.frmResched.cmdReplace.Visible(False)
		Gui.frmResched.lblRtrNote.Visible(False)
	F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.Label("chkReplace_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf
Program.Sub.chkReplace_Click.End

Program.Sub.cmdRouter_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdRouter_Click_Err")
F.Intrinsic.Control.ClearErrors
V.Local.sError.Declare(String)

V.Local.sRet.Declare(String)
V.Local.sTitles.Declare(String)
V.Local.iWidths.Declare(Long)

F.Intrinsic.String.Split("Router*!*Rev*!*Description","*!*",V.Local.sTitles)
F.Intrinsic.String.Split("500*!*200*!*800","*!*",V.Local.iWidths)

F.Intrinsic.UI.SetBrowserHotTypeAhead(True)
F.Intrinsic.UI.Browser("Select Router:","con","SELECT SUBSTRING(ROUTER, 1, 17) AS Router, SUBSTRING(ROUTER, 18, 3) AS Rev, DESCR AS Description FROM ROUTER_XREF ORDER BY Router,Rev",V.Local.sTitles,V.Local.iWidths,V.Local.sRet)

F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
	F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
	F.Intrinsic.String.GSSPartString(V.Local.sRet(0),V.Local.sRet(1),V.Global.sRouter)
	Gui.frmResched.txtRouter.Text(V.Global.sRouter.Trim)
	V.Global.sNewRouter.Set("")
	Gui.frmResched.GsGCRouter.Visible(False)
	F.Intrinsic.Control.CallSub(LoadDTRouter)
	Gui.frmResched.GsGCRouter.Visible(True)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.Label("cmdRouter_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdRouter_Click.End

Program.Sub.txtRouter_LostFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtRouter_LostFocus_Err")
F.Intrinsic.Control.ClearErrors
V.Local.sError.Declare(String)

	V.Local.iRet.Declare(Long)

	F.Intrinsic.Control.If(V.Screen.frmResched!txtRouter.Text,<>,"")	
		F.Intrinsic.Control.If(V.DataTable.dtRouter.Exists)
			F.Intrinsic.UI.Msgbox("Do you want to load select router?","Load",4,V.Local.iRet)
			F.Intrinsic.Control.If(V.Local.iRet,=,6)
			V.Global.sRouter.Set(V.Screen.frmResched!txtRouter.Text)
				V.Global.sNewRouter.Set("")
				Gui.frmResched.GsGCRouter.Visible(False)
				F.Intrinsic.Control.CallSub(LoadDTRouter)
				Gui.frmResched.GsGCRouter.Visible(True)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Else
			V.Global.sRouter.Set(V.Screen.frmResched!txtRouter.Text)
			V.Global.sNewRouter.Set("")
			Gui.frmResched.GsGCRouter.Visible(False)
			F.Intrinsic.Control.CallSub(LoadDTRouter)
			Gui.frmResched.GsGCRouter.Visible(True)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.Label("txtRouter_LostFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf
Program.Sub.txtRouter_LostFocus.End

Program.Sub.cmdReplace_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdReplace_Click_Err")
F.Intrinsic.Control.ClearErrors
V.Local.sError.Declare(String)

	V.Local.sRet.Declare(String)
	V.Local.sCaption.Declare(String)
	V.Local.sTitles.Declare(String)
	V.Local.iWidths.Declare(Long)

	F.Intrinsic.String.Split("Router*!*Rev*!*Description","*!*",V.Local.sTitles)
	F.Intrinsic.String.Split("500*!*200*!*800","*!*",V.Local.iWidths)

	F.Intrinsic.UI.SetBrowserHotTypeAhead(True)
	F.Intrinsic.UI.Browser("Select Router:","con","SELECT SUBSTRING(ROUTER, 1, 17) AS Router, SUBSTRING(ROUTER, 18, 3) AS Rev, DESCR AS Description FROM ROUTER_XREF ORDER BY Router,Rev",V.Local.sTitles,V.Local.iWidths,V.Local.sRet)

	F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
		F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
		F.Intrinsic.String.GSSPartString(V.Local.sRet(0),V.Local.sRet(1),V.Global.sNewRouter)
		V.Global.sNewRouterDesc.Set(V.Local.sRet(2))
		Gui.frmResched.txtReplace.Text(V.Global.sNewRouter)
		F.Intrinsic.String.Build("***Jobs using the Current Router {0} are going to be updated to use the New Router {1}***",V.Global.sRouter.Trim,V.Global.sNewRouter.Trim,V.Local.sCaption)
		Gui.frmResched.lblRtrNote.Caption(V.Local.sCaption)
	F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.Label("cmdReplace_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdReplace_Click.End

Program.Sub.LoadDTRouter.Start
F.Intrinsic.Control.SetErrorHandler("LoadDTRouter_Err")
F.Intrinsic.Control.ClearErrors
V.Local.sError.Declare(String)

	V.Local.sRet.Declare(String)
	V.Local.sSQL.Declare(String)

	Gui.frmResched.lblStatus.Caption("Loading Work Orders....")
	Gui.frmResched.lblStatus.Visible(True)
	Gui.frmResched.pbStatus.Visible(True)
	Gui.frmResched.pbStatus.Min(0)
	Gui.frmResched.pbStatus.Max(100)
	Gui.frmResched.pbStatus.Value(0)

	F.Intrinsic.Control.If(V.DataTable.dtRouter.Exists)
		F.Data.DataTable.Close("dtRouter")
	F.Intrinsic.Control.EndIf

	F.Intrinsic.String.Build("SELECT JOB,SUFFIX,PART,DESCRIPTION,DATE_DUE,QTY_ORDER FROM V_JOB_HEADER WHERE ROUTER = '{0}' AND DATE_CLOSED = '1900-01-01' ORDER BY JOB, SUFFIX;",V.Global.sRouter.Trim,V.Local.sSQL)
	F.ODBC.Connection!con.OpenRecordsetRO("rstJob",V.Local.sSQL)
		F.Intrinsic.Control.If(V.ODBC.con!rstJob.EOF,=,False)
			F.Data.DataTable.CreateFromSQL("dtRouter","con",V.Local.sSQL,True)
			F.Data.DataTable.AddColumn("dtRouter","Select",Boolean,False)
			F.Data.DataTable.AddColumn("dtRouter","PO_Only",Boolean,False)
			F.Data.DataTable.AddColumn("dtRouter","Job_Detail",Boolean,False)
			F.Data.DataTable.AddColumn("dtRouter","Scheduled",Boolean,False)
			Gui.frmResched.pbStatus.Value(30)
			F.Intrinsic.Control.CallSub(checkdetail)
			Gui.frmResched.pbStatus.Value(60)
			F.Intrinsic.Control.CallSub(loadgvrouter)
			Gui.frmResched.pbStatus.Value(90)
		F.Intrinsic.Control.Else
			F.Intrinsic.String.Build("Router ({0}) has no open work orders.",V.Global.sRouter.Trim,V.Local.sRet)
			F.Intrinsic.UI.Msgbox(V.Local.sRet,"Work Order Check")
			F.Intrinsic.Control.If(V.DataTable.dtRouter.Exists)
				Gui.frmResched.GsGCRouter.ClearRows("gvRouter")
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
	F.ODBC.con!rstJob.Close

	Gui.frmResched.pbStatus.Value(100)
	Gui.frmResched.lblStatus.Visible(False)
	Gui.frmResched.pbStatus.Visible(False)

F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.Label("LoadDTRouter_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf
Program.Sub.LoadDTRouter.End

Program.Sub.CheckDetail.Start
F.Intrinsic.Control.SetErrorHandler("CheckDetail_Err")
F.Intrinsic.Control.ClearErrors
V.Local.sError.Declare(String)

V.Local.sSQL.Declare(String)
V.Local.sRet.Declare(String)
V.Local.iCnt.Declare(Long,0)
V.Local.iC.Declare(Long,-1)
V.Local.sJob.Declare(String)
V.Local.sSuffix.Declare(String)

F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtRouter.RowCount--,1)
	F.Intrinsic.Math.Add(V.Local.iC,1,V.Local.iC)
		V.Local.sJob.Set(V.DataTable.dtRouter(V.Local.iCnt).JOB!FieldValTrim)
		V.Local.sSuffix.Set(V.DataTable.dtRouter(V.Local.iCnt).SUFFIX!FieldValTrim)
		F.Intrinsic.String.Build("SELECT JOB,SUFFIX,SEQ,REFERENCE,QTY_COMMITTED FROM JOB_DETAIL WHERE JOB = '{0}' AND SUFFIX = '{1}';",V.Local.sJob,V.Local.sSuffix,V.Local.sSQL)
		F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSQL,V.Local.sRet)
		F.Intrinsic.Control.If(V.Local.sRet,=,"")
			F.Data.DataTable.SetValue("dtRouter",V.Local.iCnt,"PO_Only",False,"Job_Detail",False)
		F.Intrinsic.Control.Else
			F.ODBC.Connection!con.OpenRecordsetRO("rstJobDtl",V.Local.sSQL)
				F.Intrinsic.Control.DoUntil(V.ODBC.con!rstJobDtl.EOF,=,True)
					F.Intrinsic.Control.If(V.ODBC.con!rstJobDtl.FieldValFloat!QTY_COMMITTED,!=,0)
						F.Data.DataTable.SetValue("dtRouter",V.Local.iCnt,"PO_Only",True)
					F.Intrinsic.Control.Else
						F.Data.DataTable.SetValue("dtRouter",V.Local.iCnt,"Job_Detail",True)
					F.Intrinsic.Control.EndIf
				F.ODBC.con!rstJobDtl.MoveNext
				F.Intrinsic.Control.Loop
			F.ODBC.con!rstJobDtl.Close
		F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Next(V.Local.iCnt)

F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.Label("CheckDetail_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf
Program.Sub.CheckDetail.End

Program.Sub.LoadGVRouter.Start
F.Intrinsic.Control.SetErrorHandler("LoadGVRouter_Err")
F.Intrinsic.Control.ClearErrors
V.Local.sError.Declare(String)

	V.Local.iCnt.Declare(Long)

	Gui.frmResched.GsGCRouter.AddGridViewFromDataTable("gvRouter","dtRouter")

	Gui.frmResched.GsGCRouter.SetGridViewProperty("gvRouter","MultiSelect",True)
	Gui.frmResched.GsGCRouter.SetGridViewProperty("gvRouter","AllowSort",True)
	Gui.frmResched.GsGCRouter.SetGridViewProperty("gvRouter","AllowFilter",True)
	Gui.frmResched.GsGCRouter.SetGridViewProperty("gvRouter","Editable",False)
	Gui.frmResched.GsGCRouter.SetGridViewProperty("gvRouter","ReadOnly",True)
	Gui.frmResched.GsGCRouter.SetGridViewProperty("gvRouter","OptionsDetailShowDetailTabs",False)
	Gui.frmResched.GsGCRouter.SetGridViewProperty("gvRouter","OptionsViewShowGroupPanel",True)

	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","Select","Caption","Select")
	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","PO_Only","Caption","PO Only")
	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","Job_Detail","Caption","Job Detail")
	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","JOB","Caption","Job ")
	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","SUFFIX","Caption","Suffix ")
	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","PART","Caption","Part ")
	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","DESCRIPTION","Caption","Description ")
	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","DATE_DUE","Caption","Due Date")
	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","QTY_ORDER","Caption","Order Qty")
	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","Scheduled","Caption","Scheduled")

	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","Select","VisibleIndex","0")
	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","PO_Only","VisibleIndex","1")
	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","Job_Detail","VisibleIndex","2")
	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","JOB","VisibleIndex","3")
	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","SUFFIX","VisibleIndex","4")
	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","PART","VisibleIndex","5")
	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","DESCRIPTION","VisibleIndex","7")
	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","DATE_DUE","VisibleIndex","8")
	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","QTY_ORDER","VisibleIndex","9")
	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","Scheduled","VisibleIndex","10")

	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","Select","MinWidth","50")
	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","PO_Only","MinWidth","50")
	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","Job_Detail","MinWidth","50")
	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","JOB","MinWidth","80")
	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","SUFFIX","MinWidth","30")
	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","PART","MinWidth","100")
	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","DESCRIPTION","MinWidth","200")
	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","DATE_DUE","MinWidth","80")
	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","QTY_ORDER","MinWidth","80")
	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","Scheduled","MinWidth","50")

	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","Select","HeaderHAlignment","Center")
	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","PO_Only","HeaderHAlignment","Center")
	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","Job_Detail","HeaderHAlignment","Center")
	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","JOB","HeaderHAlignment","Center")
	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","SUFFIX","HeaderHAlignment","Center")
	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","DATE_DUE","HeaderHAlignment","Center")
	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","QTY_ORDER","HeaderHAlignment","Far")
	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","Scheduled","HeaderHAlignment","Center")

	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","JOB","CellHAlignment","Center")
	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","SUFFIX","CellHAlignment","Center")
	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","DATE_DUE","CellHAlignment","Center")

	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","JOB","CellForeColor","Blue")
	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","SUFFIX","CellForeColor","Blue")

	Gui.frmResched.GsGCRouter.SetColumnProperty("gvRouter","DATE_DUE","DisplayCustomDatetime","d")

	Gui.frmResched.GsGCRouter.MainView("gvRouter")

	F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtRouter.RowCount--,1)
		Gui.frmResched.GsGCRouter.SetRowAppearance("gvRouter",v.Local.iCnt,"BackColor","WhiteSmoke")

		F.Intrinsic.Control.If(V.DataTable.dtRouter(V.Local.iCnt).PO_Only!FieldVal,=,False)
			F.Intrinsic.Control.AndIf(V.DataTable.dtRouter(V.Local.iCnt).Job_Detail!FieldVal,=,False)
				Gui.frmResched.GsGCRouter.SetCellAppearance("gvRouter",6,V.Local.iCnt,"BackColor","White")
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(v.Local.iCnt)

F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.Label("LoadGVRouter_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf
Program.Sub.LoadGVRouter.End

Program.Sub.GsGCRouter_RowCellClick.Start
F.Intrinsic.Control.SetErrorHandler("GsGCRouter_RowCellClick_Err")
F.Intrinsic.Control.ClearErrors
V.Local.sError.Declare(String)

	V.Local.sJob.Declare(String)
	V.Local.sSuffix.Declare(String)
	V.Local.bSel.Declare(Boolean)
	V.Local.bPO.Declare(Boolean)
	V.Local.bDetail.Declare(Boolean)
	V.Local.bSched.Declare(Boolean)
	V.Local.sParams.Declare(String)
	V.Local.sMsg.Declare(String)
	V.Local.iRet.Declare(Long)

	Gui.frmResched.GsGCRouter.GetCellValue("gvRouter",0,V.Args.RowIndex,V.Local.sJob)
	Gui.frmResched.GsGCRouter.GetCellValue("gvRouter",1,V.Args.RowIndex,V.Local.sSuffix)
	Gui.frmResched.GsGCRouter.GetCellValue("gvRouter",6,V.Args.RowIndex,V.Local.bSel)
	Gui.frmResched.GsGCRouter.GetCellValue("gvRouter",7,V.Args.RowIndex,V.Local.bPO)
	Gui.frmResched.GsGCRouter.GetCellValue("gvRouter",8,V.Args.RowIndex,V.Local.bDetail)
	Gui.frmResched.GsGCRouter.GetCellValue("gvRouter",9,V.Args.RowIndex,V.Local.bSched)

	F.Intrinsic.Control.SelectCase(V.Args.Column)
		F.Intrinsic.Control.Case("Select")
			F.Intrinsic.Control.If(V.Local.bPO,=,False)
			F.Intrinsic.Control.AndIf(V.Local.bDetail,=,False)
			F.Intrinsic.Control.AndIf(V.Local.bSched,=,False)
				F.Intrinsic.Control.If(V.Local.bSel)
					F.Data.DataTable.SetValue("dtRouter",V.Args.RowIndex,"Select",False)
				F.Intrinsic.Control.Else
					F.Data.DataTable.SetValue("dtRouter",V.Args.RowIndex,"Select",True)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf

		F.Intrinsic.Control.CaseAny("JOB","SUFFIX")
			F.Intrinsic.String.Build("{0}!*!{1}!*!O",V.Local.sJob,V.Local.sSuffix,V.Local.sParams)
			F.Global.General.CallWrapperSync(2009,V.Local.sParams)

			F.Intrinsic.Control.If(V.Local.sSuffix,=,"")
				F.Intrinsic.String.Build("Did you schedule the Work Order ({0})",V.Local.sJob,V.Local.sMsg)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("Did you schedule the Work Order ({0}-{1})",V.Local.sJob,V.Local.sSuffix,V.Local.sMsg)
			F.Intrinsic.Control.EndIf

			F.Intrinsic.UI.Msgbox(V.Local.sMsg,"Scheduled?",4,V.Local.iRet)
			F.Intrinsic.Control.If(V.Local.iRet,=,6)
				F.Data.DataTable.SetValue("dtRouter",V.Args.RowIndex,"Scheduled",True)
				Gui.frmResched.GsGCRouter.SetCellAppearance("gvRouter",6,V.Args.RowIndex,"BackColor","WhiteSmoke")
			F.Intrinsic.Control.EndIf
		f.Intrinsic.Control.Case("Releasedd")
	F.Intrinsic.Control.EndSelect

F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.Label("GsGCRouter_RowCellClick_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf
Program.Sub.GsGCRouter_RowCellClick.End

Program.Sub.cmdPart_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdPart_Click_Err")
F.Intrinsic.Control.ClearErrors
V.Local.sError.Declare(String)

	V.Local.sRet.Declare(String)

	F.Intrinsic.UI.SetBrowserHotTypeAhead(True)
	F.Intrinsic.UI.Browser(105,"",V.Local.sRet)

	F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
		F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
		V.Global.sPart.Set(V.Local.sRet(0).Trim)
		V.Global.sLoc.Set(V.Local.sRet(1).Trim)
		V.Global.sNewPart.Set("")
		V.Global.sNewLoc.Set("")
		Gui.frmResched.txtPart.Text(V.Global.sPart)
		Gui.frmResched.txtLoc.Text(V.Global.sLoc)
		Gui.frmResched.txtNewPart.Text(V.Global.sNewPart)
		Gui.frmResched.txtNewLoc.Text(V.Global.sNewLoc)
		Gui.frmResched.GsGCPart.Visible(False)
		F.Intrinsic.Control.CallSub(loadDTPart)
		Gui.frmResched.GsGCPart.Visible(True)
	F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.Label("cmdPart_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdPart_Click.End

Program.Sub.cmdNewPart_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdNewPart_Click_Err")
F.Intrinsic.Control.ClearErrors
V.Local.sError.Declare(String)

	V.Local.sRet.Declare(String)

	F.Intrinsic.UI.Browser(105,"",V.Local.sRet)

	F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
		F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)

		F.Intrinsic.Control.If(V.Screen.frmResched!txtLoc.Text,<>,V.Local.sRet(1).Trim)
			F.Intrinsic.UI.Msgbox("Parts must have the same Location","Wrong Location")
		F.Intrinsic.Control.Else
			V.Global.sNewPart.Set(V.Local.sRet(0).Trim)
			V.Global.sNewLoc.Set(V.Local.sRet(1).Trim)
			V.Global.sNewPartDesc.Set(V.Local.sRet(2).Trim)
			Gui.frmResched.txtNewPart.Text(V.Global.sNewPart)
			Gui.frmResched.txtNewLoc.Text(V.Global.sNewLoc)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.Label("cmdNewPart_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdNewPart_Click.End

Program.Sub.txtLoc_LostFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtLoc_LostFocus_Err")
F.Intrinsic.Control.ClearErrors
V.Local.sError.Declare(String)

	V.Local.iRet.Declare(Long)

	F.Intrinsic.Control.If(V.Screen.frmResched!txtPart.Text,<>,"")	
'		F.Intrinsic.Control.If(V.DataTable.dtRouter.Exists)
'			F.Intrinsic.UI.Msgbox("Do you want to load select router?","Load",4,V.Local.iRet)
'			F.Intrinsic.Control.If(V.Local.iRet,=,6)
'			V.Global.sRouter.Set(V.Screen.frmResched!txtRouter.Text)
'				V.Global.sNewRouter.Set("")
'				Gui.frmResched.GsGCRouter.Visible(False)
'				F.Intrinsic.Control.CallSub(LoadDTRouter)
'				Gui.frmResched.GsGCRouter.Visible(True)
'			F.Intrinsic.Control.EndIf
'		F.Intrinsic.Control.Else
'			V.Global.sRouter.Set(V.Screen.frmResched!txtRouter.Text)
'			V.Global.sNewRouter.Set("")
'			Gui.frmResched.GsGCRouter.Visible(False)
'			F.Intrinsic.Control.CallSub(LoadDTRouter)
'			Gui.frmResched.GsGCRouter.Visible(True)
'		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf



F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.Label("txtLoc_LostFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf
Program.Sub.txtLoc_LostFocus.End

Program.Sub.txtNewLoc_LostFocus.Start
Program.Sub.txtNewLoc_LostFocus.End

Program.Sub.LoadDTPart.Start
F.Intrinsic.Control.SetErrorHandler("LoadDTPart_Err")
F.Intrinsic.Control.ClearErrors
V.Local.sError.Declare(String)

	V.Local.sRet.Declare(String)
	V.Local.sSQL.Declare(String)

	Gui.frmResched.lblStatus.Caption("Loading Work Orders....")
	Gui.frmResched.lblStatus.Visible(True)
	Gui.frmResched.pbStatus.Visible(True)
	Gui.frmResched.pbStatus.Min(0)
	Gui.frmResched.pbStatus.Max(100)
	Gui.frmResched.pbStatus.Value(5)

	F.Intrinsic.Control.If(V.DataTable.dtPart.Exists)
		F.Data.DataTable.Close("dtPart")
	F.Intrinsic.Control.EndIf

	F.Intrinsic.String.Build("SELECT VJO.JOB,VJO.SUFFIX,VJO.SEQ,VJO.PART,VJH.LOCATION,VJO.DESCRIPTION,VJO.SETUP,VJO.SETUP AS SETUP2,VJO.UNITS AS RUNTIME,VJO.UNITS AS RUNTIME2,VJH.DATE_DUE,VJH.DATE_OPENED,VJO.HOURS_ESTIMATED,VJH.QTY_ORDER FROM V_JOB_OPERATIONS VJO LEFT JOIN V_JOB_HEADER VJH ON VJO.JOB = VJH.JOB AND VJO.SUFFIX = VJH.SUFFIX WHERE LMO = 'M' AND VJO.PART = '{0}' AND VJH.LOCATION = '{1}' AND VJO.FLAG_CLOSED <> 'Y' AND DATE_CLOSED = '1900-01-01' ORDER BY VJH.DATE_OPENED DESC;",V.Global.sPart.Trim,V.Global.sLoc.Trim,V.Local.sSQL)
	F.ODBC.Connection!con.OpenRecordsetRO("rstPart",V.Local.sSQL)
		F.Intrinsic.Control.If(V.ODBC.con!rstPart.EOF,=,False)
			F.Data.DataTable.CreateFromSQL("dtPart","con",V.Local.sSQL,True)
			F.Data.DataTable.AddColumn("dtPart","Select",Boolean,False)
			Gui.frmResched.pbStatus.Value(45)
			F.Intrinsic.Control.CallSub(LoadGVPart)
			Gui.frmResched.pbStatus.Value(75)
		F.Intrinsic.Control.Else
			F.Intrinsic.String.Build("Part:{0} Loc:{1} is not on any open work orders.",V.Global.sPart.Trim,V.Global.sLoc.Trim,V.Local.sRet)
			F.Intrinsic.UI.Msgbox(V.Local.sRet,"Work Order Check")
			F.Intrinsic.Control.If(V.DataTable.dtPart.Exists)
				Gui.frmResched.GsGCPart.ClearRows("gvPart")
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
	F.ODBC.con!rstPart.Close

	Gui.frmResched.pbStatus.Value(100)
	Gui.frmResched.lblStatus.Visible(False)
	Gui.frmResched.pbStatus.Visible(False)

F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.Label("LoadDTPart_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf
Program.Sub.LoadDTPart.End

Program.Sub.LoadGVPart.Start
F.Intrinsic.Control.SetErrorHandler("LoadGVPart_Err")
F.Intrinsic.Control.ClearErrors
V.Local.sError.Declare(String)

	V.Local.iCnt.Declare(Long)

	Gui.frmResched.GsGCPart.AddGridViewFromDataTable("gvPart","dtPart")

	Gui.frmResched.GsGCPart.SetGridViewProperty("gvPart","MultiSelect",True)
	Gui.frmResched.GsGCPart.SetGridViewProperty("gvPart","AllowSort",True)
	Gui.frmResched.GsGCPart.SetGridViewProperty("gvPart","AllowFilter",True)
	Gui.frmResched.GsGCPart.SetGridViewProperty("gvPart","OptionsDetailShowDetailTabs",False)
	Gui.frmResched.GsGCPart.SetGridViewProperty("gvPart","OptionsViewShowGroupPanel",True)

	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","SETUP","Visible",False)
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","RUNTIME","Visible",False)

	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","Select","VisibleIndex","0")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","JOB","VisibleIndex","1")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","SUFFIX","VisibleIndex","2")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","SEQ","VisibleIndex","3")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","PART","VisibleIndex","4")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","LOCATION","VisibleIndex","5")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","DESCRIPTION","VisibleIndex","6")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","SETUP2","VisibleIndex","7")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","RUNTIME2","VisibleIndex","8")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","DATE_OPENED","VisibleIndex","9")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","DATE_DUE","VisibleIndex","10")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","QTY_ORDER","VisibleIndex","11")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","HOURS_ESTIMATED","VisibleIndex","12")

	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","Select","Caption","Select")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","JOB","Caption","Job ")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","SUFFIX","Caption","Suffix ")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","SEQ","Caption","Seq ")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","PART","Caption","Part ")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","LOCATION","Caption","Loc")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","DESCRIPTION","Caption","Description ")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","SETUP2","Caption","Setup")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","RUNTIME2","Caption","Runtime")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","DATE_OPENED","Caption","Start Date")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","DATE_DUE","Caption","Due Date")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","QTY_ORDER","Caption","WO Qty.")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","HOURS_ESTIMATED","Caption","Req'd Qty.")

	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","Select","MinWidth","50")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","JOB","MinWidth","80")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","SUFFIX","MinWidth","55")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","SEQ","MinWidth","80")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","PART","MinWidth","100")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","LOCATION","MinWidth","35")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","DESCRIPTION","MinWidth","200")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","SETUP2","MinWidth","80")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","RUNTIME2","MinWidth","80")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","DATE_OPENED","MinWidth","80")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","DATE_DUE","MinWidth","80")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","QTY_ORDER","MinWidth","80")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","HOURS_ESTIMATED","MinWidth","80")

	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","Select","HeaderHAlignment","Center")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","JOB","HeaderHAlignment","Center")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","SUFFIX","HeaderHAlignment","Center")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","SEQ","HeaderHAlignment","Center")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","LOCATION","HeaderHAlignment","Center")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","SETUP2","HeaderHAlignment","Far")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","RUNTIME2","HeaderHAlignment","Far")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","DATE_OPENED","HeaderHAlignment","Center")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","DATE_DUE","HeaderHAlignment","Center")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","QTY_ORDER","HeaderHAlignment","Far")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","HOURS_ESTIMATED","HeaderHAlignment","Far")

	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","Select","CellHAlignment","Center")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","JOB","CellHAlignment","Center")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","SUFFIX","CellHAlignment","Center")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","SEQ","CellHAlignment","Center")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","LOCATION","CellHAlignment","Center")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","SETUP2","CellHAlignment","Far")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","RUNTIME2","CellHAlignment","Far")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","DATE_OPENED","CellHAlignment","Center")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","DATE_DUE","CellHAlignment","Center")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","QTY_ORDER","CellHAlignment","Far")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","HOURS_ESTIMATED","CellHAlignment","Far")

	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","Select","AllowEdit",True)
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","JOB","AllowEdit",False)
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","SUFFIX","AllowEdit",False)
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","SEQ","AllowEdit",False)
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","LOCATION","AllowEdit",False)
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","SETUP2","AllowEdit",True)
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","RUNTIME2","AllowEdit",True)
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","DATE_OPENED","AllowEdit",False)
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","DATE_DUE","AllowEdit",False)
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","QTY_ORDER","AllowEdit",False)
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","HOURS_ESTIMATED","AllowEdit",False)

	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","Select","ReadOnly",False)
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","JOB","ReadOnly",True)
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","SUFFIX","ReadOnly",True)
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","SEQ","ReadOnly",True)
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","LOCATION","ReadOnly",True)
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","SETUP2","ReadOnly",False)
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","RUNTIME2","ReadOnly",False)
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","DATE_OPENED","ReadOnly",True)
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","DATE_DUE","ReadOnly",True)
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","QTY_ORDER","ReadOnly",True)
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","HOURS_ESTIMATED","ReadOnly",True)

	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","Select","Fixed","Left")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","JOB","Fixed","Left")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","SUFFIX","Fixed","Left")

	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","Select","CellBackColor","LightYellow")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","SETUP2","CellBackColor","LightYellow")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","RUNTIME2","CellBackColor","LightYellow")

	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","SETUP2","DisplayCustomNumeric","#,###,###,##0.0000")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","RUNTIME2","DisplayCustomNumeric","#,###,###,##0.0000")

	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","DATE_OPENED","DisplayCustomDatetime","d")
	Gui.frmResched.GsGCPart.SetColumnProperty("gvPart","DATE_DUE","DisplayCustomDatetime","d")

	F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtPart.RowCount--,1)
		Gui.frmResched.GsGCPart.SetRowAppearance("gvPart",V.Local.iCnt,"BackColor","WhiteSmoke")
	F.Intrinsic.Control.Next(V.Local.iCnt)

	Gui.frmResched.GsGCPart.MainView("gvPart")

F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.Label("LoadGVPart_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf
Program.Sub.LoadGVPart.End

Program.Sub.GsGCPart_CellValueChanged.Start
F.Intrinsic.Control.SetErrorHandler("GsGCPart_CellValueChanged_Err")
F.Intrinsic.Control.ClearErrors
V.Local.sError.Declare(String)

	V.Local.fSetup.Declare(Float)
	V.Local.fNewSetup.Declare(Float)
	V.Local.fRuntime.Declare(Float)
	V.Local.fNewRuntime.Declare(Float)

	F.Intrinsic.Control.SelectCase(V.Args.Column)
		F.Intrinsic.Control.CaseAny("SETUP2","RUNTIME2")
			Gui.frmResched.GsGCPart.GetCellValue("gvPart",6,V.Args.RowIndex,V.Local.fSetup)
			Gui.frmResched.GsGCPart.GetCellValue("gvPart",7,V.Args.RowIndex,V.Local.fNewSetup)
			Gui.frmResched.GsGCPart.GetCellValue("gvPart",8,V.Args.RowIndex,V.Local.fRuntime)
			Gui.frmResched.GsGCPart.GetCellValue("gvPart",9,V.Args.RowIndex,V.Local.fNewRuntime)
			F.Intrinsic.Control.If(V.Local.fNewSetup,<>,V.Local.fSetup,"OR",V.Local.fNewRuntime.Trim,<>,V.Local.fRuntime.Trim)
				F.Data.DataTable.SetValue("dtPart",V.Args.RowIndex,"Select",True)
			F.Intrinsic.Control.Else
				F.Data.DataTable.SetValue("dtPart",V.Args.RowIndex,"Select",False)
			F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.EndSelect
	
F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.Label("GsGCPart_CellValueChanged_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf
Program.Sub.GsGCPart_CellValueChanged.End

Program.Sub.tabResched_Click.Start
F.Intrinsic.Control.SetErrorHandler("tabResched_Click_Err")
F.Intrinsic.Control.ClearErrors
V.Local.sError.Declare(String)

	F.Intrinsic.Control.SelectCase(V.Screen.frmResched!tabResched.Tab)
		F.Intrinsic.Control.Case(0)
			Gui.frmResched.frameTotals.Visible(True)
		F.Intrinsic.Control.Case(1)
			Gui.frmResched.frameTotals.Visible(False)
		F.Intrinsic.Control.Case(2)
			Gui.frmResched.frameTotals.Visible(False)
	F.Intrinsic.Control.EndSelect

F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.Label("tabResched_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf
Program.Sub.tabResched_Click.End

Program.Sub.cmdDeptBrowse_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdDeptBrowse_Click_Err")
F.Intrinsic.Control.ClearErrors



V.Local..BulkDeclareString(sDept, ssql, sSeq, sNext, sCurrent, sTitles, sRet, sJob, sSuffix, sPrevSeq, sPrevClsd)
V.Local..BulkDeclareLong(iWidths, iCnt, iLate)
V.Local..BulkDeclareFloat(fPrevQty)

Function.Intrinsic.String.Split("Department ID*!*Department Name","*!*",variable.local.sTitles)
Function.Intrinsic.String.Split("2000*!*3000","*!*",variable.local.iWidths)
Function.Intrinsic.UI.Browser("Select a Department","con","Select Dept_ID, DEPT_NAME From V_DEPARTMENTS",Variable.Local.sTitles,Variable.Local.iWidths,Variable.Local.sRet)
Function.Intrinsic.Control.If(Variable.Local.sRet,"=","***CANCEL***")
 	Function.Intrinsic.UI.Msgbox("No department was selected!")
Function.Intrinsic.Control.Else
 Function.Intrinsic.String.Split(Variable.Local.sRet,"*!*",Variable.Local.sRet)
	gui.frmResched.txtDept.Text(v.Local.sret(0))
Function.Intrinsic.Control.EndIf

'""""""""""""""""""""""""""""""""""""""""""""""""""""""""" ADDING TO POPULATE WHEN DEPARTMENT IS SELECTED  """""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
Gui.frmResched.lblStatus.Caption("Loading Work Orders....")
	Gui.frmResched.lblStatus.Visible(True)
	Gui.frmResched.pbStatus.Visible(True)

	F.Intrinsic.Control.If(V.DataTable.dtWC.Exists)
		F.Data.DataTable.Close("dtWC")
		F.Data.Dictionary.Close("dicDept")
	F.Intrinsic.Control.EndIf

	f.Intrinsic.Control.If(v.Screen.frmResched!txtDept.text,=,"")
		F.Data.Dictionary.CreateFromSQL("dicDept","con","SELECT MACHINE,WC_DEPT FROM WORKCENTERS ORDER BY MACHINE;")
	f.Intrinsic.Control.Else
		f.Intrinsic.String.Build("SELECT MACHINE,WC_DEPT FROM WORKCENTERS where WC_DEPT = '{0}' ORDER BY MACHINE",v.Screen.frmResched!txtDept.text,v.local.sdept)
		F.Data.Dictionary.CreateFromSQL("dicDept","con",v.Local.sdept)
	f.Intrinsic.Control.EndIf

	F.Intrinsic.Control.If(V.Screen.frmResched!optWC.Value)
		f.Intrinsic.Control.If(v.Screen.frmResched!txtDept.text,=,"")
			F.Intrinsic.String.Build("SELECT IF(A.SFX = '',A.JOB,A.JOB + '-' + A.SFX) AS WO,A.JOB,A.SFX,B.PRIORITY,B.PRIORITY AS PRIORITY2,A.SEQ,A.SEQRES AS WC,(SELECT WC_DEPT FROM WORKCENTERS WHERE A.SEQRES = WORKCENTERS.MACHINE) AS DEPT,B.PART,B.PART_DESCRIPTION,A.STARTDATE,A.DUEDATE,B.DATE_DUE,B.DATE_DUE AS DATE_DUE2,B.SCHEDULED_DUE_DATE AS SCHED_DATE,A.INITSU+A.HOURSORIG AS EST_HRS,HOURSAPPL AS ACT_HRS,IF(A.INITSU+A.HOURSORIG = 0,0,(A.INITSU+A.HOURSORIG)- HOURSAPPL) AS REM_HRS,A.PCSTOPROD AS EST_QTY,A.PCSREMAIN AS REM_QTY,B.DATE_START FROM APSV3_JBLINES A LEFT JOIN V_JOB_HEADER B ON A.JOB = B.JOB AND A.SFX = B.SUFFIX WHERE A.SEQTYPE = '1' AND A.SEQRES = '{0}' AND COMPLDATE IS NULL AND A.JOBTYPE <> 2 ORDER BY A.STARTDATE,A.JOB,A.SFX,A.SEQ;",V.Screen.frmResched!ddlWC.Text,V.Local.sSQL)
		f.Intrinsic.Control.Else
			F.Intrinsic.String.Build("SELECT IF(A.SFX = '',A.JOB,A.JOB + '-' + A.SFX) AS WO,A.JOB,A.SFX,B.PRIORITY,B.PRIORITY AS PRIORITY2,A.SEQ,A.SEQRES AS WC,(SELECT WC_DEPT FROM WORKCENTERS WHERE A.SEQRES = WORKCENTERS.MACHINE) AS DEPT,B.PART,B.PART_DESCRIPTION,A.STARTDATE,A.DUEDATE,B.DATE_DUE,B.DATE_DUE AS DATE_DUE2,B.SCHEDULED_DUE_DATE AS SCHED_DATE,A.INITSU+A.HOURSORIG AS EST_HRS,HOURSAPPL AS ACT_HRS,IF(A.INITSU+A.HOURSORIG = 0,0,(A.INITSU+A.HOURSORIG)- HOURSAPPL) AS REM_HRS,A.PCSTOPROD AS EST_QTY,A.PCSREMAIN AS REM_QTY,B.DATE_START FROM APSV3_JBLINES A LEFT JOIN V_JOB_HEADER B ON A.JOB = B.JOB AND A.SFX = B.SUFFIX WHERE A.SEQTYPE = '1'  AND COMPLDATE IS NULL AND A.JOBTYPE <> 2 and DEPT = '{0}' ORDER BY A.STARTDATE,A.JOB,A.SFX,A.SEQ;",v.Screen.frmResched!txtDept.text,v.Local.sSQL)
		f.Intrinsic.Control.EndIf

		F.Data.DataTable.CreateFromSQL("dtWC","con",V.Local.sSQL,True)
	F.Intrinsic.Control.Else
		f.Intrinsic.Control.If(v.Screen.frmResched!txtDept.text,=,"")
				F.Intrinsic.String.Build("SELECT IF(A.SFX = '',A.JOB,A.JOB + '-' + A.SFX) AS WO,A.JOB,A.SFX,B.PRIORITY,B.PRIORITY AS PRIORITY2,A.SEQ,RTRIM((SELECT TOP 1 SAR FROM APSV3_UBDETAIL WHERE A.JSS = APSV3_UBDETAIL.JSS)) AS WC,RTRIM((SELECT TOP 1 SAR FROM APSV3_UBDETAIL WHERE A.JSS = APSV3_UBDETAIL.JSS)) AS DEPT,B.PART,B.PART_DESCRIPTION,A.STARTDATE,A.DUEDATE,B.DATE_DUE,B.DATE_DUE AS DATE_DUE2,B.SCHEDULED_DUE_DATE AS SCHED_DATE,A.INITSU+A.HOURSORIG AS EST_HRS,HOURSAPPL AS ACT_HRS,IF(A.INITSU+A.HOURSORIG = 0,0,(A.INITSU+A.HOURSORIG)- HOURSAPPL) AS REM_HRS,A.PCSTOPROD AS EST_QTY,A.PCSREMAIN AS REM_QTY,B.DATE_START FROM APSV3_JBLINES A LEFT JOIN V_JOB_HEADER B ON A.JOB = B.JOB AND A.SFX = B.SUFFIX WHERE A.SEQTYPE = '1' AND A.SEQRES = '{0}' AND A.COMPLDATE IS NULL AND A.JOBTYPE <> 2 AND WC IS NOT NULL ORDER BY A.STARTDATE,A.JOB,A.SFX,A.SEQ;",V.Screen.frmResched!ddlWG.Text,v.Local.sSQL)
		f.Intrinsic.Control.Else
			F.Intrinsic.String.Build("SELECT IF(A.SFX = '',A.JOB,A.JOB + '-' + A.SFX) AS WO,A.JOB,A.SFX,B.PRIORITY,B.PRIORITY AS PRIORITY2,A.SEQ,RTRIM((SELECT TOP 1 SAR FROM APSV3_UBDETAIL WHERE A.JSS = APSV3_UBDETAIL.JSS)) AS WC,RTRIM((SELECT TOP 1 SAR FROM APSV3_UBDETAIL WHERE A.JSS = APSV3_UBDETAIL.JSS)) AS DEPT,B.PART,B.PART_DESCRIPTION,A.STARTDATE,A.DUEDATE,B.DATE_DUE,B.DATE_DUE AS DATE_DUE2,B.SCHEDULED_DUE_DATE AS SCHED_DATE,A.INITSU+A.HOURSORIG AS EST_HRS,HOURSAPPL AS ACT_HRS,IF(A.INITSU+A.HOURSORIG = 0,0,(A.INITSU+A.HOURSORIG)- HOURSAPPL) AS REM_HRS,A.PCSTOPROD AS EST_QTY,A.PCSREMAIN AS REM_QTY,B.DATE_START FROM APSV3_JBLINES A LEFT JOIN V_JOB_HEADER B ON A.JOB = B.JOB AND A.SFX = B.SUFFIX WHERE A.SEQTYPE = '1' AND A.SEQRES = '{0}' AND A.COMPLDATE IS NULL AND A.JOBTYPE <> 2 AND WC IS NOT NULL  and DEPT = '{1}' ORDER BY A.STARTDATE,A.JOB,A.SFX,A.SEQ;",V.Screen.frmResched!ddlWG.Text,v.Screen.frmResched!txtDept.Text,v.Local.sSQL)
		f.Intrinsic.Control.EndIf

		F.Data.DataTable.CreateFromSQL("dtWC","con",V.Local.sSQL,True)
		F.Data.DataTable.FillFromDictionary("dtWC","dicDept","DEPT")
	F.Intrinsic.Control.EndIf

	F.Data.DataTable.AddColumn("dtWC","Select",Boolean,False)
	F.Data.DataTable.AddColumn("dtWC","PrevSeq",String)
	F.Data.DataTable.AddColumn("dtWC","PrevQty",Float)
	F.Data.DataTable.AddColumn("dtWC","PrevClsd",String)
	F.Data.DataTable.AddColumn("dtWC","CurrentOp",String)

	'added by WAW
	f.Data.DataTable.AddColumn("dtWC","NextOp",String)
	f.Data.DataTable.AddColumn("dtWC","DaysLate",Float)
	f.Data.DataTable.AddColumn("dtWC","EstStart",String)	
	f.Data.DataTable.AddColumn("dtWC","EstEnd",String)	
	F.Data.DataTable.AddColumn("dtWC","Released",Boolean,False)

	Gui.frmResched.pbStatus.Min(0)

	F.Intrinsic.Control.If(V.DataTable.dtWC.RowCount,<>,0)
		Gui.frmResched.pbStatus.Max(V.DataTable.dtWC.RowCount)
		Gui.frmResched.pbStatus.Value(0)
	F.Intrinsic.Control.Else
		Gui.frmResched.pbStatus.Value(0)
	F.Intrinsic.Control.EndIf
	v.Local.icounter.Declare(long,0)
	v.Local.sbtm.Declare(String)
	v.Local.setm.declare(String)
	v.Local.sbeg.Declare(String)
	v.Local.send.Declare(String)

	v.Local.iest.Declare(long,0)

	F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtWC.RowCount--,1)

		'added by WAW clear the local variables
		v.Local.scurrent.Set("")
		v.Local.snext.Set("")
		v.Local.iLate.Set(0)

		v.Local.sSeq.Set(V.DataTable.dtWC(V.Local.iCnt).SEQ!FieldValTrim)
		f.Intrinsic.String.LPad(v.Local.sSeq,"0",6,v.Local.sSeq)

		F.Intrinsic.String.Build("SELECT TOP 1(BDATE), BTM, ETM from APSV3_UBDETAIL where JOB = '{0}' AND SFX = '{1}' and SEQ = '{2}' order by BDATE ASC",V.DataTable.dtWC(V.Local.iCnt).JOB!FieldValTrim,V.DataTable.dtWC(V.Local.iCnt).SFX!FieldValTrim,V.Local.sSeq.Trim,V.Local.ssql)
		F.ODBC.Connection!con.OpenLocalRecordsetRO("rstInfo",V.Local.sSQL)
		f.Intrinsic.Control.if(v.ODBC.con!rstInfo.EOF,=,false)
			F.Data.DataTable.SetValue("dtWC",v.Local.iCnt,"EstStart",V.ODBC.con!rstInfo.FieldValTrim!BTM)
			F.Data.DataTable.SetValue("dtWC",v.Local.iCnt,"EstEnd",V.ODBC.con!rstInfo.FieldValTrim!ETM)
			f.Intrinsic.Control.EndIf
		f.ODBC.con!rstInfo.Close	

		f.Intrinsic.Date.DateDiff("d",v.datatable.dtwc(v.Local.icnt).DATE_DUE2.fieldvaltrim,v.datatable.dtwc(v.Local.icnt).SCHED_DATE.fieldvaltrim,v.local.iLate)
		F.Data.DataTable.SetValue("dtWC",v.Local.iCnt,"DaysLate",V.Local.iLate)

		'added by WAW to get the next operation in line	
		F.Intrinsic.String.Build("SELECT TOP 2 A.JOB,A.SFX,A.SEQ,A.SEQTYPE,A.SEQRES,A.PCSREMAIN,A.STARTDATE,(SELECT WC_DEPT FROM WORKCENTERS WHERE A.SEQRES = WORKCENTERS.MACHINE) AS DEPT FROM APSV3_JBLINES A WHERE A.COMPLDATE IS NULL AND A.SEQTYPE <> '2' AND A.JOB = '{0}' AND A.SFX = '{1}' ORDER BY A.JOB,A.SFX,A.SEQ",V.DataTable.dtWC(V.Local.iCnt).JOB!FieldValTrim,V.DataTable.dtWC(V.Local.iCnt).SFX!FieldValTrim,V.Local.sSQL)
		F.ODBC.Connection!con.OpenLocalRecordsetRO("rstInfo",V.Local.sSQL)
		f.Intrinsic.Control.DoUntil(v.ODBC.con!rstInfo.EOF,=,True)
			f.Intrinsic.Control.If(v.Local.icounter,>,0)
				v.Local.snext.Set(v.ODBC.con!rstInfo.FieldValTrim!SEQRES)

			f.Intrinsic.Control.Else
				v.Local.scurrent.Set(v.ODBC.con!rstInfo.FieldValTrim!SEQRES)
				f.Intrinsic.Math.Add(v.Local.icounter,1,v.Local.icounter)
			f.Intrinsic.control.endif	
		F.ODBC.con!rstinfo.MoveNext
		Function.Intrinsic.Control.Loop
		f.ODBC.con!rstInfo.Close

		F.Data.DataTable.SetValue("dtWC",v.Local.iCnt,"CurrentOp",V.Local.scurrent)
		F.Data.DataTable.SetValue("dtWC",v.Local.iCnt,"NextOp",V.Local.snext)
		v.Local.scurrent.Set("")
		v.Local.snext.Set("")
		v.Local.icounter.Set(0)

		'query for the flag that would determine if it has been Released or not
		f.Intrinsic.String.Build("Select FLAG_WO_PRTD from V_JOB_HEADER where JOB = '{0}' and SUFFIX = '{1}'",V.DataTable.dtWC(V.Local.iCnt).JOB!FieldValTrim,V.DataTable.dtWC(V.Local.iCnt).SFX!FieldValTrim,v.Local.sSQL)
		F.ODBC.Connection!con.OpenLocalRecordsetRO("rstInfo",V.Local.sSQL)
		f.Intrinsic.Control.If(v.ODBC.con!rstInfo.EOF,=,False)
			f.Intrinsic.Control.If(v.ODBC.con!rstInfo.FieldValTrim!FLAG_WO_PRTD,=,"R")
				F.Data.DataTable.SetValue("dtWC",v.Local.iCnt,"Released",True)
			f.Intrinsic.Control.EndIf
		f.Intrinsic.Control.Else
			F.Data.DataTable.SetValue("dtWC",v.Local.iCnt,"Released",False)
		f.Intrinsic.Control.EndIf
		f.ODBC.con!rstInfo.Close

		Gui.frmResched.pbStatus.Value(V.Local.iCnt)
		V.Local.sJob.Set(V.DataTable.dtWC(V.Local.iCnt).JOB!FieldValTrim)
		V.Local.sSuffix.Set(V.DataTable.dtWC(V.Local.iCnt).SFX!FieldValTrim)
		V.Local.sSeq.Set(V.DataTable.dtWC(V.Local.iCnt).SEQ!FieldValTrim)

		F.Intrinsic.String.Build("SELECT TOP 1 SEQ,UNITS_COMPLETE,FLAG_CLOSED FROM V_JOB_OPERATIONS WHERE JOB = '{0}' AND SUFFIX = '{1}' AND SEQ < {2} AND LMO = 'L' ORDER BY SEQ DESC",V.Local.sJob,V.Local.sSuffix,V.Local.sSeq,V.Local.sSQL)
		F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSQL,V.Local.sRet)
		F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
		V.Local.sPrevSeq.Set(V.Local.sRet(0))
		V.Local.fPrevQty.Set(V.Local.sRet(1).Float)
		V.Local.sPrevClsd.Set(V.Local.sRet(2))
		F.Intrinsic.Control.If(V.Local.sPrevClsd,=,"OOB")
			V.Local.sPrevClsd.Set("")
		F.Intrinsic.Control.EndIf
		F.Data.DataTable.SetValue("dtWC",V.Local.iCnt,"PrevSeq",V.Local.sPrevSeq,"PrevQty",V.Local.fPrevQty,"PrevClsd",V.Local.sPrevClsd)
	F.Intrinsic.Control.Next(V.Local.iCnt)

	F.Intrinsic.Control.CallSub(loadgvwc)

	Gui.frmResched.lblStatus.Visible(False)
	Gui.frmResched.pbStatus.Visible(False)

'""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.Label("cmdDeptBrowse_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdDeptBrowse_Click.End

Program.Sub.cmdDisplay_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdDisplay_Click_Err")
F.Intrinsic.Control.ClearErrors
V.Local.sError.Declare(String)


V.Local.fPrevQty.Declare
V.Local..BulkDeclareDate(dDueDate, dSchedDueDate)
V.Local..BulkDeclareString(sSQL,sRet,sJob, sSuffix, sPrevSeq, sPrevClsd, scurrent,snext, snewquery, sSeq, sMM, sHH, sTime, sSeqType, sStartTime, sDept, sOutside,sBTM, sETM, sBeg, sEnd)
V.Local..BulkDeclareLong(iCnt, iLate, iLen, iHrs, iLoop, iCounter, iEST)
	
Gui.frmResched.lblStatus.Caption("Loading Work Orders....")
Gui.frmResched.lblStatus.Visible(True)
Gui.frmResched.pbStatus.Visible(True)

F.Intrinsic.Control.If(V.DataTable.dtWC.Exists)
	F.Data.DataTable.Close("dtWC")
	F.Data.Dictionary.Close("dicDept")
F.Intrinsic.Control.EndIf

f.Intrinsic.Control.If(v.Screen.frmResched!txtDept.text,=,"")
	F.Data.Dictionary.CreateFromSQL("dicDept","con","SELECT MACHINE,WC_DEPT FROM WORKCENTERS ORDER BY MACHINE;")
f.Intrinsic.Control.Else
	f.Intrinsic.String.Build("SELECT MACHINE,WC_DEPT FROM WORKCENTERS where WC_DEPT = '{0}' ORDER BY MACHINE",v.Screen.frmResched!txtDept.text,v.local.sdept)
	F.Data.Dictionary.CreateFromSQL("dicDept","con",v.Local.sdept)
f.Intrinsic.Control.EndIf
'""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
F.Intrinsic.Control.If(V.Screen.frmResched!optWC.Value)
	'this is for WC data
	f.Intrinsic.Control.If(v.Screen.frmResched!txtDept.text,=,"")
		F.Intrinsic.String.Build("SELECT IF(A.SFX = '',A.JOB,A.JOB + '-' + A.SFX) AS WO,A.JOB,A.SFX,B.PRIORITY,B.PRIORITY AS PRIORITY2,A.SEQ,A.SEQRES AS WC,(SELECT WC_DEPT FROM WORKCENTERS WHERE A.SEQRES = WORKCENTERS.MACHINE) AS DEPT,B.PART,B.PART_DESCRIPTION,A.STARTDATE,A.DUEDATE,B.DATE_DUE,B.DATE_DUE AS DATE_DUE2,B.SCHEDULED_DUE_DATE AS SCHED_DATE,A.INITSU+A.HOURSORIG AS EST_HRS,HOURSAPPL AS ACT_HRS,IF(A.INITSU+A.HOURSORIG = 0,0,(A.INITSU+A.HOURSORIG)- HOURSAPPL) AS REM_HRS,A.PCSTOPROD AS EST_QTY,A.PCSREMAIN AS REM_QTY,B.DATE_START FROM APSV3_JBLINES A LEFT JOIN V_JOB_HEADER B ON A.JOB = B.JOB AND A.SFX = B.SUFFIX WHERE A.SEQTYPE = '1' AND A.SEQRES IN ('{0}') AND COMPLDATE IS NULL AND A.JOBTYPE <> 2 ORDER BY A.STARTDATE,A.JOB,A.SFX,A.SEQ;",V.Global.sWCdisplay,V.Local.sSQL)
	f.Intrinsic.Control.ElseIf(V.Global.sWCdisplay,<>,"")
		F.Intrinsic.String.Build("SELECT IF(A.SFX = '',A.JOB,A.JOB + '-' + A.SFX) AS WO,A.JOB,A.SFX,B.PRIORITY,B.PRIORITY AS PRIORITY2,A.SEQ,A.SEQRES AS WC,(SELECT WC_DEPT FROM WORKCENTERS WHERE A.SEQRES = WORKCENTERS.MACHINE) AS DEPT,B.PART,B.PART_DESCRIPTION,A.STARTDATE,A.DUEDATE,B.DATE_DUE,B.DATE_DUE AS DATE_DUE2,B.SCHEDULED_DUE_DATE AS SCHED_DATE,A.INITSU+A.HOURSORIG AS EST_HRS,HOURSAPPL AS ACT_HRS,IF(A.INITSU+A.HOURSORIG = 0,0,(A.INITSU+A.HOURSORIG)- HOURSAPPL) AS REM_HRS,A.PCSTOPROD AS EST_QTY,A.PCSREMAIN AS REM_QTY,B.DATE_START FROM APSV3_JBLINES A LEFT JOIN V_JOB_HEADER B ON A.JOB = B.JOB AND A.SFX = B.SUFFIX WHERE A.SEQTYPE = '1' AND A.SEQRES IN ('{0}') AND COMPLDATE IS NULL AND A.JOBTYPE <> 2 and DEPT = '{1}' ORDER BY A.STARTDATE,A.JOB,A.SFX,A.SEQ;",V.Global.sWCdisplay,v.Screen.frmResched!txtDept.text,v.Local.sSQL)
	f.Intrinsic.Control.Else
		F.Intrinsic.String.Build("SELECT IF(A.SFX = '',A.JOB,A.JOB + '-' + A.SFX) AS WO,A.JOB,A.SFX,B.PRIORITY,B.PRIORITY AS PRIORITY2,A.SEQ,A.SEQRES AS WC,(SELECT WC_DEPT FROM WORKCENTERS WHERE A.SEQRES = WORKCENTERS.MACHINE) AS DEPT,B.PART,B.PART_DESCRIPTION,A.STARTDATE,A.DUEDATE,B.DATE_DUE,B.DATE_DUE AS DATE_DUE2,B.SCHEDULED_DUE_DATE AS SCHED_DATE,A.INITSU+A.HOURSORIG AS EST_HRS,HOURSAPPL AS ACT_HRS,IF(A.INITSU+A.HOURSORIG = 0,0,(A.INITSU+A.HOURSORIG)- HOURSAPPL) AS REM_HRS,A.PCSTOPROD AS EST_QTY,A.PCSREMAIN AS REM_QTY,B.DATE_START FROM APSV3_JBLINES A LEFT JOIN V_JOB_HEADER B ON A.JOB = B.JOB AND A.SFX = B.SUFFIX WHERE A.SEQTYPE = '1'  AND COMPLDATE IS NULL AND A.JOBTYPE <> 2 and DEPT = '{0}' ORDER BY A.STARTDATE,A.JOB,A.SFX,A.SEQ;",v.Screen.frmResched!txtDept.text,v.Local.sSQL)
	f.Intrinsic.Control.EndIf

	F.Data.DataTable.CreateFromSQL("dtWC","con",V.Local.sSQL,True)
F.Intrinsic.Control.Else
	'this is for WG data
	f.Intrinsic.Control.If(v.Screen.frmResched!txtDept.text,=,"")
		F.Intrinsic.String.Build("SELECT IF(A.SFX = '',A.JOB,A.JOB + '-' + A.SFX) AS WO,A.JOB,A.SFX,B.PRIORITY,B.PRIORITY AS PRIORITY2,A.SEQ,RTRIM((SELECT TOP 1 SAR FROM APSV3_UBDETAIL WHERE A.JSS = APSV3_UBDETAIL.JSS)) AS WC,RTRIM((SELECT TOP 1 SAR FROM APSV3_UBDETAIL WHERE A.JSS = APSV3_UBDETAIL.JSS)) AS DEPT,B.PART,B.PART_DESCRIPTION,A.STARTDATE,A.DUEDATE,B.DATE_DUE,B.DATE_DUE AS DATE_DUE2,B.SCHEDULED_DUE_DATE AS SCHED_DATE,A.INITSU+A.HOURSORIG AS EST_HRS,HOURSAPPL AS ACT_HRS,IF(A.INITSU+A.HOURSORIG = 0,0,(A.INITSU+A.HOURSORIG)- HOURSAPPL) AS REM_HRS,A.PCSTOPROD AS EST_QTY,A.PCSREMAIN AS REM_QTY,B.DATE_START FROM APSV3_JBLINES A LEFT JOIN V_JOB_HEADER B ON A.JOB = B.JOB AND A.SFX = B.SUFFIX WHERE A.SEQTYPE = '1' AND A.SEQRES IN ('{0}') AND A.COMPLDATE IS NULL AND A.JOBTYPE <> 2 AND WC IS NOT NULL ORDER BY A.STARTDATE,A.JOB,A.SFX,A.SEQ;",V.Global.sWGdisplay,v.Local.sSQL)
	f.Intrinsic.Control.ElseIf(V.Global.sWGdisplay,<>,"")
		F.Intrinsic.String.Build("SELECT IF(A.SFX = '',A.JOB,A.JOB + '-' + A.SFX) AS WO,A.JOB,A.SFX,B.PRIORITY,B.PRIORITY AS PRIORITY2,A.SEQ,RTRIM((SELECT TOP 1 SAR FROM APSV3_UBDETAIL WHERE A.JSS = APSV3_UBDETAIL.JSS)) AS WC,RTRIM((SELECT TOP 1 SAR FROM APSV3_UBDETAIL WHERE A.JSS = APSV3_UBDETAIL.JSS)) AS DEPT,B.PART,B.PART_DESCRIPTION,A.STARTDATE,A.DUEDATE,B.DATE_DUE,B.DATE_DUE AS DATE_DUE2,B.SCHEDULED_DUE_DATE AS SCHED_DATE,A.INITSU+A.HOURSORIG AS EST_HRS,HOURSAPPL AS ACT_HRS,IF(A.INITSU+A.HOURSORIG = 0,0,(A.INITSU+A.HOURSORIG)- HOURSAPPL) AS REM_HRS,A.PCSTOPROD AS EST_QTY,A.PCSREMAIN AS REM_QTY,B.DATE_START FROM APSV3_JBLINES A LEFT JOIN V_JOB_HEADER B ON A.JOB = B.JOB AND A.SFX = B.SUFFIX WHERE A.SEQTYPE = '1' AND A.SEQRES IN ('{0}') AND A.COMPLDATE IS NULL AND A.JOBTYPE <> 2 AND WC IS NOT NULL  and DEPT = '{1}' ORDER BY A.STARTDATE,A.JOB,A.SFX,A.SEQ;",V.Global.sWGdisplay,v.Screen.frmResched!txtDept.Text,v.Local.sSQL)
	f.Intrinsic.Control.Else
		F.Intrinsic.String.Build("SELECT IF(A.SFX = '',A.JOB,A.JOB + '-' + A.SFX) AS WO,A.JOB,A.SFX,B.PRIORITY,B.PRIORITY AS PRIORITY2,A.SEQ,RTRIM((SELECT TOP 1 SAR FROM APSV3_UBDETAIL WHERE A.JSS = APSV3_UBDETAIL.JSS)) AS WC,RTRIM((SELECT TOP 1 SAR FROM APSV3_UBDETAIL WHERE A.JSS = APSV3_UBDETAIL.JSS)) AS DEPT,B.PART,B.PART_DESCRIPTION,A.STARTDATE,A.DUEDATE,B.DATE_DUE,B.DATE_DUE AS DATE_DUE2,B.SCHEDULED_DUE_DATE AS SCHED_DATE,A.INITSU+A.HOURSORIG AS EST_HRS,HOURSAPPL AS ACT_HRS,IF(A.INITSU+A.HOURSORIG = 0,0,(A.INITSU+A.HOURSORIG)- HOURSAPPL) AS REM_HRS,A.PCSTOPROD AS EST_QTY,A.PCSREMAIN AS REM_QTY,B.DATE_START FROM APSV3_JBLINES A LEFT JOIN V_JOB_HEADER B ON A.JOB = B.JOB AND A.SFX = B.SUFFIX WHERE A.SEQTYPE = '1' AND A.COMPLDATE IS NULL AND A.JOBTYPE <> 2 AND WC IS NOT NULL  and DEPT = '{0}' ORDER BY A.STARTDATE,A.JOB,A.SFX,A.SEQ;",v.Screen.frmResched!txtDept.Text,v.Local.sSQL)
	f.Intrinsic.Control.EndIf

	F.Data.DataTable.CreateFromSQL("dtWC","con",V.Local.sSQL,True)
	F.Data.DataTable.FillFromDictionary("dtWC","dicDept","DEPT")
F.Intrinsic.Control.EndIf
'""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
F.Data.DataTable.AddColumn("dtWC","Select",Boolean,False)
F.Data.DataTable.AddColumn("dtWC","PrevSeq",String)
F.Data.DataTable.AddColumn("dtWC","PrevQty",Float)
F.Data.DataTable.AddColumn("dtWC","PrevClsd",String)
F.Data.DataTable.AddColumn("dtWC","CurrentOp",String)

'added by WAW
f.Data.DataTable.AddColumn("dtWC","NextOp",String)
f.Data.DataTable.AddColumn("dtWC","DaysLate",Float)
f.Data.DataTable.AddColumn("dtWC","EstStart",String)	
f.Data.DataTable.AddColumn("dtWC","EstEnd",String)	
F.Data.DataTable.AddColumn("dtWC","Released",Boolean,False)

Gui.frmResched.pbStatus.Min(0)

F.Intrinsic.Control.If(V.DataTable.dtWC.RowCount,<>,0)
	Gui.frmResched.pbStatus.Max(V.DataTable.dtWC.RowCount)
	Gui.frmResched.pbStatus.Value(0)
F.Intrinsic.Control.Else
	Gui.frmResched.pbStatus.Value(0)
F.Intrinsic.Control.EndIf
V.Local.icounter.Set(0)
V.Local.iest.Set(0)

F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtWC.RowCount--,1)

'added by WAW clear the local variables
'		v.Local.scurrent.Set("")
'		v.Local.snext.Set("")
v.Local.ilate.Set(0)

v.Local.sSeq.Set(V.DataTable.dtWC(V.Local.iCnt).SEQ!FieldValTrim)
f.Intrinsic.String.LPad(v.Local.sSeq,"0",6,v.Local.sSeq)

F.Intrinsic.String.Build("SELECT TOP 1(BDATE), BTM, ETM from APSV3_UBDETAIL where JOB = '{0}' AND SFX = '{1}' and SEQ = '{2}' order by BDATE ASC",V.DataTable.dtWC(V.Local.iCnt).JOB!FieldValTrim,V.DataTable.dtWC(V.Local.iCnt).SFX!FieldValTrim,V.Local.sSeq.Trim,V.Local.ssql)
F.ODBC.Connection!con.OpenLocalRecordsetRO("rstInfo",V.Local.sSQL)
f.Intrinsic.Control.if(v.ODBC.con!rstInfo.EOF,=,false)
	F.Data.DataTable.SetValue("dtWC",v.Local.iCnt,"EstStart",V.ODBC.con!rstInfo.FieldValTrim!BTM)
	F.Data.DataTable.SetValue("dtWC",v.Local.iCnt,"EstEnd",V.ODBC.con!rstInfo.FieldValTrim!ETM)
	f.Intrinsic.Control.EndIf
f.ODBC.con!rstInfo.Close	

f.Intrinsic.Date.DateDiff("d",v.datatable.dtwc(v.Local.icnt).DATE_DUE2.fieldvaltrim,v.datatable.dtwc(v.Local.icnt).SCHED_DATE.fieldvaltrim,v.local.ilate)
F.Data.DataTable.SetValue("dtWC",v.Local.iCnt,"DaysLate",V.Local.ilate)

'added by WAW to get the next operation in line	
F.Intrinsic.String.Build("SELECT TOP 2 A.JOB,A.SFX,A.SEQ,A.SEQTYPE,A.SEQRES,A.PCSREMAIN,A.STARTDATE,(SELECT WC_DEPT FROM WORKCENTERS WHERE A.SEQRES = WORKCENTERS.MACHINE) AS DEPT FROM APSV3_JBLINES A WHERE A.COMPLDATE IS NULL AND A.SEQTYPE <> '2' AND A.JOB = '{0}' AND A.SFX = '{1}' ORDER BY A.JOB,A.SFX,A.SEQ",V.DataTable.dtWC(V.Local.iCnt).JOB!FieldValTrim,V.DataTable.dtWC(V.Local.iCnt).SFX!FieldValTrim,V.Local.sSQL)
F.ODBC.Connection!con.OpenLocalRecordsetRO("rstInfo",V.Local.sSQL)
f.Intrinsic.Control.DoUntil(v.ODBC.con!rstInfo.EOF,=,True)
	f.Intrinsic.Control.If(v.Local.icounter,>,0)
		v.Local.snext.Set(v.ODBC.con!rstInfo.FieldValTrim!SEQRES)

	f.Intrinsic.Control.Else
		v.Local.scurrent.Set(v.ODBC.con!rstInfo.FieldValTrim!SEQRES)
		f.Intrinsic.Math.Add(v.Local.icounter,1,v.Local.icounter)
	f.Intrinsic.control.endif	
F.ODBC.con!rstinfo.MoveNext
Function.Intrinsic.Control.Loop
f.ODBC.con!rstInfo.Close

F.Data.DataTable.SetValue("dtWC",v.Local.iCnt,"CurrentOp",V.Local.scurrent)
F.Data.DataTable.SetValue("dtWC",v.Local.iCnt,"NextOp",V.Local.snext)
v.Local.scurrent.Set("")
v.Local.snext.Set("")
v.Local.icounter.Set(0)

'query for the flag that would determine if it has bee Releasedd or not
f.Intrinsic.String.Build("Select FLAG_WO_PRTD from V_JOB_HEADER where JOB = '{0}' and SUFFIX = '{1}'",V.DataTable.dtWC(V.Local.iCnt).JOB!FieldValTrim,V.DataTable.dtWC(V.Local.iCnt).SFX!FieldValTrim,v.Local.sSQL)
F.ODBC.Connection!con.OpenLocalRecordsetRO("rstInfo",V.Local.sSQL)
f.Intrinsic.Control.If(v.ODBC.con!rstInfo.EOF,=,False)
	f.Intrinsic.Control.If(v.ODBC.con!rstInfo.FieldValTrim!FLAG_WO_PRTD,=,"R")
		F.Data.DataTable.SetValue("dtWC",v.Local.iCnt,"Released",True)
	f.Intrinsic.Control.EndIf
f.Intrinsic.Control.Else
	F.Data.DataTable.SetValue("dtWC",v.Local.iCnt,"Released",False)
f.Intrinsic.Control.EndIf
f.ODBC.con!rstInfo.Close

Gui.frmResched.pbStatus.Value(V.Local.iCnt)
V.Local.sJob.Set(V.DataTable.dtWC(V.Local.iCnt).JOB!FieldValTrim)
V.Local.sSuffix.Set(V.DataTable.dtWC(V.Local.iCnt).SFX!FieldValTrim)
V.Local.sSeq.Set(V.DataTable.dtWC(V.Local.iCnt).SEQ!FieldValTrim)

F.Intrinsic.String.Build("SELECT TOP 1 SEQ,UNITS_COMPLETE,FLAG_CLOSED FROM V_JOB_OPERATIONS WHERE JOB = '{0}' AND SUFFIX = '{1}' AND SEQ < {2} AND LMO = 'L' ORDER BY SEQ DESC",V.Local.sJob,V.Local.sSuffix,V.Local.sSeq,V.Local.sSQL)
F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSQL,V.Local.sRet)
F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
V.Local.sPrevSeq.Set(V.Local.sRet(0))
V.Local.fPrevQty.Set(V.Local.sRet(1).Float)
V.Local.sPrevClsd.Set(V.Local.sRet(2))
F.Intrinsic.Control.If(V.Local.sPrevClsd,=,"OOB")
	V.Local.sPrevClsd.Set("")
F.Intrinsic.Control.EndIf
F.Data.DataTable.SetValue("dtWC",V.Local.iCnt,"PrevSeq",V.Local.sPrevSeq,"PrevQty",V.Local.fPrevQty,"PrevClsd",V.Local.sPrevClsd)
F.Intrinsic.Control.Next(V.Local.iCnt)

F.Intrinsic.Control.CallSub(loadgvwc)

Gui.frmResched.lblStatus.Visible(False)
Gui.frmResched.pbStatus.Visible(False)

F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.Label("cmdDisplay_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_4617_Repl_Upd_Resched_Utility.g2u",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	Function.Intrinsic.Control.CallSub(frmresched_unload)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdDisplay_Click.End

Program.Sub.Comments.Start
${$0$}$GAB_4228_Repl_Upd_Resched_Utility$}$AGV$}$9/22/2016 9:45:29 AM$}$False
${$3$}$0$}$$}$0$}$-1$}$$}$12:00:00 AM$}$This will be a custom GAB script that will run from a custom Menu Item under Bill of Material -> File -> Custom Cobalt BOM Import.  The user will navigate to the xml file that needs to be loaded into Global Shop.  Once the xml is parsed there will be a search in Global Shop to see if a BOM already exists for that Part Number.  If one already exists a compare screen will display showing the differences between the two.  If one does not exist then the screen will display the BOM as it will be uploaded into Global Shop.  Any parts that are listed in the BOM that are not Inventory Parts will be highlighted in Yellow.  If there are any parts not in inventory the user will have the option to click the create Parts button to generate those parts in Global Shop.  If the BOM exists in Global shop then any differences on the new import will be highlighted in Red.  After the Parts have been created then the Upload button will upload and override any previous BOM for that part.
Program.Sub.Comments.End